(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[766],{3234:(e,t,l)=>{"use strict";l.r(t),l.d(t,{textConfig:()=>n});let n={id:"text",type:"text",name:"文本",icon:"\uD83D\uDD24",defaultProps:{text:"文本内容"},defaultStyle:{fontSize:"14",color:"#333333",paddingTop:"8",paddingRight:"8",paddingBottom:"8",paddingLeft:"8",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!1,description:"用于显示文本内容",propertyConfig:{props:[{title:"内容",key:"content",controls:[{type:"textarea",label:"文本内容",key:"text",placeholder:"请输入文本内容"}]}],styles:l(14285).N}}},6582:(e,t,l)=>{"use strict";l.r(t),l.d(t,{dividerConfig:()=>n});let n={id:"divider",type:"divider",name:"分割线",icon:"➖",defaultProps:{},defaultStyle:{width:"100%",height:"1",backgroundColor:"#e8e8e8",marginTop:"16",marginRight:"0",marginBottom:"16",marginLeft:"0"},canHaveChildren:!1,description:"用于分割内容的线条",propertyConfig:{props:[],styles:[{title:"尺寸",key:"size",controls:[{type:"number",label:"宽度",key:"width",placeholder:"100%",min:0},{type:"number",label:"高度",key:"height",placeholder:"1",min:1,unit:"px"}]},{title:"外边距",key:"margin",controls:[{type:"number",label:"上",key:"marginTop",placeholder:"16",min:0,unit:"px"},{type:"number",label:"下",key:"marginBottom",placeholder:"16",min:0,unit:"px"}]},{title:"颜色",key:"color",controls:[{type:"color",label:"背景颜色",key:"backgroundColor"}]}]}}},14285:(e,t,l)=>{"use strict";l.d(t,{N:()=>n,w:()=>a});let n=[{title:"尺寸",key:"size",controls:[{type:"number",label:"宽度",key:"width",placeholder:"auto",min:0,unit:"px"},{type:"number",label:"高度",key:"height",placeholder:"auto",min:0,unit:"px"}]},{title:"外边距",key:"margin",controls:[{type:"number",label:"上",key:"marginTop",placeholder:"0",min:0,unit:"px"},{type:"number",label:"右",key:"marginRight",placeholder:"0",min:0,unit:"px"},{type:"number",label:"下",key:"marginBottom",placeholder:"0",min:0,unit:"px"},{type:"number",label:"左",key:"marginLeft",placeholder:"0",min:0,unit:"px"}]},{title:"内边距",key:"padding",controls:[{type:"number",label:"上",key:"paddingTop",placeholder:"0",min:0,unit:"px"},{type:"number",label:"右",key:"paddingRight",placeholder:"0",min:0,unit:"px"},{type:"number",label:"下",key:"paddingBottom",placeholder:"0",min:0,unit:"px"},{type:"number",label:"左",key:"paddingLeft",placeholder:"0",min:0,unit:"px"}]},{title:"颜色",key:"color",controls:[{type:"color",label:"文字颜色",key:"color"},{type:"color",label:"背景颜色",key:"backgroundColor"}]},{title:"字体",key:"font",controls:[{type:"number",label:"字体大小",key:"fontSize",placeholder:"14",min:1,max:200,unit:"px"},{type:"select",label:"字体粗细",key:"fontWeight",options:[{label:"正常",value:"normal"},{label:"粗体",value:"bold"},{label:"细体",value:"lighter"}]}]},{title:"边框",key:"border",controls:[{type:"number",label:"边框宽度",key:"borderWidth",placeholder:"0",min:0,max:50,unit:"px"},{type:"select",label:"边框样式",key:"borderStyle",options:[{label:"实线",value:"solid"},{label:"虚线",value:"dashed"},{label:"点线",value:"dotted"}]},{type:"color",label:"边框颜色",key:"borderColor"},{type:"number",label:"圆角",key:"borderRadius",placeholder:"0",min:0,max:100,unit:"px"}]}],a=[{title:"布局",key:"layout",controls:[{type:"select",label:"显示方式",key:"display",options:[{label:"块级",value:"block"},{label:"弹性",value:"flex"},{label:"网格",value:"grid"},{label:"隐藏",value:"none"}]},{type:"select",label:"弹性方向",key:"flexDirection",options:[{label:"横向",value:"row"},{label:"纵向",value:"column"}]},{type:"select",label:"主轴对齐",key:"justifyContent",options:[{label:"开始",value:"flex-start"},{label:"居中",value:"center"},{label:"结束",value:"flex-end"},{label:"空间分布",value:"space-between"},{label:"环绕分布",value:"space-around"}]},{type:"select",label:"交叉轴对齐",key:"alignItems",options:[{label:"开始",value:"flex-start"},{label:"居中",value:"center"},{label:"结束",value:"flex-end"},{label:"拉伸",value:"stretch"}]},{type:"number",label:"间距",key:"gap",placeholder:"0",min:0,unit:"px"}]}]},19406:(e,t,l)=>{"use strict";l.r(t),l.d(t,{imageConfig:()=>n});let n={id:"image",type:"image",name:"图片",icon:"\uD83D\uDDBC️",defaultProps:{src:"https://img4.yishouapp.com/obs/public_prefix/2025/6/25/12cd92ea3ce549964a2f3d349f2b1651.png",alt:"图片"},defaultStyle:{width:"100%",height:"auto",borderRadius:"4",objectFit:"cover",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!1,description:"用于显示图片",propertyConfig:{props:[{title:"图片",key:"image",controls:[{type:"url",label:"图片地址",key:"src",placeholder:"请输入图片URL"},{type:"text",label:"替代文本",key:"alt",placeholder:"请输入图片描述"}]}],styles:[...l(14285).N,{title:"图片属性",key:"imageProps",controls:[{type:"select",label:"适应方式",key:"objectFit",options:[{label:"填充",value:"fill"},{label:"包含",value:"contain"},{label:"覆盖",value:"cover"},{label:"无",value:"none"},{label:"缩小",value:"scale-down"}]}]}]}}},33934:(e,t,l)=>{"use strict";l.d(t,{uk:()=>x,AV:()=>p,VH:()=>i,tx:()=>d}),l(14285);class n{register(e,t,l){this.registry[e]&&console.warn("Component ".concat(e," is already registered. Overriding...")),this.registry[e]={category:t,config:l},this._allComponentsCache=null,this.categories.has(t)||this.categories.set(t,[]);let n=this.categories.get(t);n.includes(e)||n.push(e),console.log("✅ Component '".concat(e,"' registered in category '").concat(t,"'"))}registerBatch(e){e.forEach(e=>{let{type:t,category:l,config:n}=e;this.register(t,l,n)})}getComponent(e){let t=this.registry[e];return t?t.config:null}getAllComponents(){if(this._allComponentsCache&&this._componentsCacheVersion===Object.keys(this.registry).length)return this._allComponentsCache;let e={};return Object.keys(this.registry).forEach(t=>{e[t]=this.registry[t].config}),this._allComponentsCache=e,this._componentsCacheVersion=Object.keys(this.registry).length,e}getComponentsByCategory(e){let t={};return(this.categories.get(e)||[]).forEach(e=>{let l=this.registry[e];l&&(t[e]=l.config)}),t}getCategories(){return Array.from(this.categories.keys())}getStats(){let e={};return this.categories.forEach((t,l)=>{e[l]=t.length}),{total:Object.keys(this.registry).length,byCategory:e}}hasComponent(e){return void 0!==this.registry[e]}unregister(e){let t=this.registry[e];if(!t)return!1;let l=this.categories.get(t.category);if(l){let t=l.indexOf(e);t>-1&&l.splice(t,1)}return delete this.registry[e],console.log("\uD83D\uDDD1️ Component '".concat(e,"' unregistered")),!0}clear(){this.registry={},this.categories.clear(),console.log("\uD83E\uDDF9 All components cleared")}debug(){console.group("\uD83D\uDD0D Component Registry Debug Info"),console.log("Total components:",Object.keys(this.registry).length),console.log("Categories:",Array.from(this.categories.keys())),this.categories.forEach((e,t)=>{console.log("\uD83D\uDCC1 ".concat(t,":"),e)}),console.groupEnd()}constructor(){this.registry={},this.categories=new Map,this._allComponentsCache=null,this._componentsCacheVersion=0}}let a=new n;async function r(){console.log("\uD83D\uDE80 Starting component auto-registration...");try{let e=await Promise.all([Promise.resolve().then(l.bind(l,3234)).then(e=>({type:"text",category:"basic",config:e.textConfig})),Promise.resolve().then(l.bind(l,60899)).then(e=>({type:"button",category:"basic",config:e.buttonConfig})),Promise.resolve().then(l.bind(l,19406)).then(e=>({type:"image",category:"basic",config:e.imageConfig}))]),t=await Promise.all([Promise.resolve().then(l.bind(l,60701)).then(e=>({type:"input",category:"form",config:e.inputConfig}))]),n=await Promise.all([Promise.resolve().then(l.bind(l,66396)).then(e=>({type:"container",category:"layout",config:e.containerConfig})),Promise.resolve().then(l.bind(l,71825)).then(e=>({type:"card",category:"layout",config:e.cardConfig})),Promise.resolve().then(l.bind(l,6582)).then(e=>({type:"divider",category:"layout",config:e.dividerConfig})),Promise.resolve().then(l.bind(l,75163)).then(e=>({type:"space",category:"layout",config:e.spaceConfig}))]),r=await Promise.all([Promise.resolve().then(l.bind(l,43493)).then(e=>({type:"list",category:"data",config:e.listConfig}))]);a.registerBatch([...e,...t,...n,...r]),console.log("✅ Component auto-registration completed"),a.debug()}catch(e){console.error("❌ Component auto-registration failed:",e)}}function i(e){let t=a.getComponent(e);if(!t)throw Error("Unknown component type: ".concat(e));return t}let o=!1,s=null;async function d(){if(!o)return s||(console.log("\uD83D\uDD27 Initializing component system..."),s=r().then(()=>{o=!0,console.log("✅ Component system initialized")}).catch(e=>{throw console.error("❌ Component system initialization failed:",e),s=null,e}))}function c(){if(!o)try{let{textConfig:e}=l(3234),{buttonConfig:t}=l(60899),{imageConfig:n}=l(19406),{inputConfig:r}=l(60701),{containerConfig:i}=l(66396),{cardConfig:s}=l(71825),{dividerConfig:d}=l(6582),{spaceConfig:c}=l(75163),{listConfig:p}=l(43493);a.registerBatch([{type:"text",category:"basic",config:e},{type:"button",category:"basic",config:t},{type:"image",category:"basic",config:n},{type:"input",category:"form",config:r},{type:"container",category:"layout",config:i},{type:"card",category:"layout",config:s},{type:"divider",category:"layout",config:d},{type:"space",category:"layout",config:c},{type:"list",category:"data",config:p}]),o=!0,console.log("✅ Components synchronized successfully")}catch(e){throw console.error("❌ Synchronous component initialization failed:",e),Error("Component system not initialized. Please ensure all component configs are available.")}}function p(e){c();let t=a.getComponent(e);if(!t)throw Error("Unknown component type: ".concat(e));return t}let u=null,g=0;function x(){c();let e=a.getAllComponents(),t=Object.keys(e).length;return u&&g===t||(u=Object.values(e),g=t),u}d().catch(e=>{console.warn("⚠️ Component system initialization failed:",e)})},43493:(e,t,l)=>{"use strict";l.r(t),l.d(t,{listConfig:()=>a});var n=l(14285);let a={id:"list",type:"list",name:"列表",icon:"\uD83D\uDCCB",defaultProps:{},defaultStyle:{display:"flex",flexDirection:"column",gap:"4",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!0,description:"用于显示列表内容",propertyConfig:{props:[],styles:[...n.N,...n.w]}}},44311:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>$});var n=l(95155),a=l(12115),r=l(35695),i=l(10068),o=l(66766),s=l(47650),d=l(89613);function c(e){let{children:t,componentId:l,isSelected:r,componentName:o}=e,{deleteComponent:c}=(0,i.U)(),p=(0,a.useRef)(null),[u,g]=(0,a.useState)({top:0,left:0,visible:!1,isScrolling:!1}),x=(0,a.useRef)(),[h]=(0,a.useState)(!0),m=(0,a.useCallback)(()=>{if(!r||!p.current)return void g(e=>({...e,visible:!1}));let e=p.current.getBoundingClientRect(),t=e.top-32-6,l=e.left,n=globalThis.innerHeight,a=globalThis.innerWidth;t<10&&(t=e.bottom+6),t+32>n-10&&(t=e.top+6),l+180>a-10&&(l=Math.max(10,a-180-10)),g(e=>({top:t,left:l,visible:!e.isScrolling,isScrolling:e.isScrolling}))},[r]),f=(0,a.useCallback)(()=>{g(e=>({...e,isScrolling:!0,visible:!1})),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{g(e=>({...e,isScrolling:!1})),m()},300)},[m]);return(0,a.useEffect)(()=>{r?m():g(e=>({...e,visible:!1}))},[r,m]),(0,a.useEffect)(()=>{var e,t;if(!r)return;let l=[window,document.querySelector(".overflow-y-auto"),document.querySelector(".overflow-auto"),null==(e=p.current)?void 0:e.closest(".overflow-y-auto"),null==(t=p.current)?void 0:t.closest(".overflow-auto")].filter(Boolean);return l.forEach(e=>{null==e||e.addEventListener("scroll",f,{passive:!0})}),globalThis.addEventListener("resize",m,{passive:!0}),()=>{l.forEach(e=>{null==e||e.removeEventListener("scroll",f)}),globalThis.removeEventListener("resize",m),x.current&&clearTimeout(x.current)}},[r,f,m]),(0,n.jsxs)("div",{ref:p,className:"relative group",children:[t,r&&!u.isScrolling&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"absolute inset-0 border border-blue-500 rounded-sm pointer-events-none z-10 shadow-sm",children:[(0,n.jsx)("div",{className:"absolute -top-0.5 -left-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,n.jsx)("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,n.jsx)("div",{className:"absolute -bottom-0.5 -left-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,n.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"})]})}),u.visible&&h?(0,s.createPortal)((0,n.jsx)("div",{className:"fixed flex items-center space-x-1 bg-blue-500 rounded-md px-2 py-1 shadow-lg pointer-events-auto transition-opacity duration-200",style:{top:"".concat(u.top,"px"),left:"".concat(u.left,"px"),zIndex:9999},children:(0,n.jsxs)(d.Kq,{children:[(0,n.jsx)("span",{className:"text-xs text-white font-medium mr-1",children:o||"组件"}),(0,n.jsxs)(d.bL,{children:[(0,n.jsx)(d.l9,{asChild:!0,children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-blue-600 rounded transition-colors","aria-label":"复制组件",children:(0,n.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})}),(0,n.jsx)(d.ZL,{children:(0,n.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["复制组件",(0,n.jsx)(d.i3,{className:"fill-gray-900"})]})})]}),(0,n.jsxs)(d.bL,{children:[(0,n.jsx)(d.l9,{asChild:!0,children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-blue-600 rounded transition-colors","aria-label":"移动组件",children:(0,n.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})})}),(0,n.jsx)(d.ZL,{children:(0,n.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["移动组件",(0,n.jsx)(d.i3,{className:"fill-gray-900"})]})})]}),(0,n.jsxs)(d.bL,{children:[(0,n.jsx)(d.l9,{asChild:!0,children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),c(l)},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-red-500 rounded transition-colors","aria-label":"删除组件",children:(0,n.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),(0,n.jsx)(d.ZL,{children:(0,n.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["删除组件",(0,n.jsx)(d.i3,{className:"fill-gray-900"})]})})]})]})}),document.body):null]})}var p=l(25472),u=l(33934),g=l(53999);function x(e){let{component:t,isSelected:l,onSelect:a,mode:r="editor"}=e,{type:s,props:d,style:h,children:m}=t,{selectedComponentId:f,selectComponent:y,currentPage:b}=(0,i.U)(),v=(0,u.AV)(s),{isOver:j,setNodeRef:C}=(0,p.zM)({id:"component-".concat(t.id),disabled:!v.canHaveChildren||"editor"!==r,data:{type:"container",componentId:t.id}}),N=e=>{e.stopPropagation(),"editor"===r&&a()},k=()=>{if("editor"===r){let e={};h&&Object.entries(h).forEach(t=>{let[l,n]=t;n&&(e[l]=(0,g.iE)(l,n))});let t={},l=null==b?void 0:b.config;l&&(!e.fontFamily&&l.fontFamily&&(t.fontFamily=l.fontFamily),!e.fontSize&&l.fontSize&&(t.fontSize=l.fontSize),!e.lineHeight&&l.lineHeight&&(t.lineHeight=l.lineHeight),!e.color&&l.color&&(t.color=l.color));let a={cursor:"pointer",transition:"all 0.2s",...t,...e};switch(s){case"text":return(0,n.jsx)("span",{style:a,onClick:N,children:d.text||"文本内容"});case"button":return(0,n.jsx)("button",{style:{...a,paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"0px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"0px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"0px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"0px",borderRadius:(null==e?void 0:e.borderRadius)||"4px",border:(null==e?void 0:e.border)||"none",backgroundColor:(null==e?void 0:e.backgroundColor)||"#1890ff",color:(null==e?void 0:e.color)||"#ffffff",fontSize:(null==e?void 0:e.fontSize)||"14px"},disabled:d.disabled,onClick:N,children:d.text||"按钮"});case"image":return(0,n.jsx)(o.default,{style:{...a,display:"block",objectFit:"cover",width:(null==e?void 0:e.width)||"auto",height:(null==e?void 0:e.height)||"auto"},src:d.src||"https://via.placeholder.com/200x150?text=图片",alt:d.alt||"图片",width:200,height:150,onClick:N});case"input":return(0,n.jsx)("input",{style:{...a,paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"8px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"12px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"8px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"12px",border:(null==e?void 0:e.border)||"1px solid #d9d9d9",borderRadius:(null==e?void 0:e.borderRadius)||"4px",fontSize:(null==e?void 0:e.fontSize)||"14px",width:(null==e?void 0:e.width)||"100%"},type:d.type||"text",placeholder:d.placeholder||"请输入内容",onClick:N,onChange:()=>{}});case"container":return(0,n.jsx)("div",{ref:C,style:{...a,minHeight:"50px",paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"16px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"16px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"16px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"16px",backgroundColor:(null==e?void 0:e.backgroundColor)||"#f5f5f5",borderRadius:(null==e?void 0:e.borderRadius)||"4px",display:(null==e?void 0:e.display)||"flex",flexDirection:(null==e?void 0:e.flexDirection)||"column",gap:null==e?void 0:e.gap,...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3"}},onClick:N,children:m&&m.length>0?m.map(e=>(0,n.jsx)(x,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,n.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"list":return(0,n.jsx)("div",{ref:C,style:{...a,display:(null==e?void 0:e.display)||"flex",flexDirection:(null==e?void 0:e.flexDirection)||"column",gap:null==e?void 0:e.gap,...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3",borderRadius:"4px",padding:"8px"}},onClick:N,children:m&&m.length>0?m.map(e=>(0,n.jsx)(x,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,n.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"card":return(0,n.jsx)("div",{ref:C,style:{...a,backgroundColor:(null==e?void 0:e.backgroundColor)||"#ffffff",border:(null==e?void 0:e.border)||"1px solid #e8e8e8",borderRadius:(null==e?void 0:e.borderRadius)||"8px",paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"16px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"16px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"16px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"16px",boxShadow:(null==e?void 0:e.boxShadow)||"0 2px 8px rgba(0,0,0,0.1)",...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3"}},onClick:N,children:m&&m.length>0?m.map(e=>(0,n.jsx)(x,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,n.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"divider":return(0,n.jsx)("div",{style:{...a,width:(null==e?void 0:e.width)||"100%",height:(null==e?void 0:e.height)||"1px",backgroundColor:(null==e?void 0:e.backgroundColor)||"#e8e8e8",margin:(null==e?void 0:e.margin)||"16px 0"},onClick:N});case"space":return(0,n.jsx)("div",{style:{...a,width:(null==e?void 0:e.width)||"100%",height:(null==e?void 0:e.height)||"16px"},onClick:N});default:return(0,n.jsxs)("div",{style:a,onClick:N,children:["未知组件类型: ",s]})}}return(0,n.jsx)("div",{children:"预览模式待实现"})};return"editor"===r?(0,n.jsx)(c,{componentId:t.id,isSelected:l,componentName:t.name,children:k()}):k()}function h(){var e,t,l,r;let{getRootComponents:o,selectedComponentId:s,selectComponent:d,currentPage:c}=(0,i.U)(),u=o(),{isOver:g,setNodeRef:h}=(0,p.zM)({id:"canvas-drop-zone",data:{type:"canvas"}});return(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s&&d(null)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[s,d]),(0,a.useEffect)(()=>{console.log("Canvas 组件数据:",{totalComponents:u.length,pageConfig:null==c?void 0:c.config,components:u.map(e=>{var t,l,n;return{id:e.id,type:e.type,name:e.name,hasChildren:!!(null==(t=e.children)?void 0:t.length),childrenCount:(null==(l=e.children)?void 0:l.length)||0,children:(null==(n=e.children)?void 0:n.map(e=>({id:e.id,type:e.type,name:e.name})))||[]}})})},[u,null==c?void 0:c.config]),(0,n.jsx)("div",{ref:h,onClick:e=>{e.target===e.currentTarget&&d(null)},onMouseDown:e=>{let t=e.clientX,l=e.clientY,n=e=>{let a=Math.abs(e.clientX-t),r=Math.abs(e.clientY-l);if(a<5&&r<5){let t=e.target;(t.classList.contains("min-h-full")||t.closest(".space-y-2"))&&d(null)}document.removeEventListener("mouseup",n)};document.addEventListener("mouseup",n)},style:(()=>{let e=null==c?void 0:c.config;if(!e)return{};let t={};return e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.backgroundImage&&(t.backgroundImage="url(".concat(e.backgroundImage,")"),t.backgroundSize="cover",t.backgroundPosition="center",t.backgroundRepeat="no-repeat"),e.minHeight&&(t.minHeight=e.minHeight),e.padding?t.padding=e.padding:(e.paddingTop&&(t.paddingTop=e.paddingTop),e.paddingRight&&(t.paddingRight=e.paddingRight),e.paddingBottom&&(t.paddingBottom=e.paddingBottom),e.paddingLeft&&(t.paddingLeft=e.paddingLeft)),e.maxWidth&&(t.maxWidth=e.maxWidth,t.marginLeft="auto",t.marginRight="auto"),e.fontFamily&&(t.fontFamily=e.fontFamily),e.fontSize&&(t.fontSize=e.fontSize),e.lineHeight&&(t.lineHeight=e.lineHeight),e.color&&(t.color=e.color),t})(),className:"min-h-full w-full transition-colors ".concat(g?"bg-blue-50 border-2 border-dashed border-blue-300":""," ").concat((null==c||null==(e=c.config)?void 0:e.padding)?"":"p-4"),children:0===u.length?(0,n.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-400 text-center",children:(0,n.jsxs)("div",{style:{fontFamily:(null==c||null==(t=c.config)?void 0:t.fontFamily)||"system-ui, -apple-system, sans-serif",fontSize:(null==c||null==(l=c.config)?void 0:l.fontSize)||"14px",lineHeight:(null==c||null==(r=c.config)?void 0:r.lineHeight)||"1.6"},children:[(0,n.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCF1"}),(0,n.jsx)("p",{className:"text-sm",children:"从左侧拖拽或点击组件来添加到页面"}),(0,n.jsx)("p",{className:"text-xs mt-2 opacity-75",children:"选中组件后按 ESC 键可取消选中"}),g&&(0,n.jsx)("p",{className:"text-xs mt-2 text-blue-600 font-medium",children:"松开鼠标放置组件"})]})}):(0,n.jsxs)("div",{children:[u.map(e=>(0,n.jsx)(x,{component:e,isSelected:s===e.id,onSelect:()=>d(e.id)},e.id)),s&&(0,n.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-3 py-1 rounded-full text-xs opacity-75 pointer-events-none z-50",children:"按 ESC 键取消选中"}),g&&(0,n.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-3 py-1 rounded-full text-xs pointer-events-none z-50",children:"松开鼠标添加组件到页面"})]})})}l(99220);var m=l(40968),f=l(14582),y=l(4884),b=l(66474),v=l(5196);function j(e){let{control:t,value:l,onChange:a}=e,{type:r,label:i,placeholder:o,options:s,min:d,max:c,step:p,unit:u}=t,x=e=>{"string"==typeof e&&"number"===r?a((0,g.iE)(t.key,e)):a(e)};return(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(m.b,{className:"block text-xs font-medium text-gray-700",children:i}),(()=>{switch(r){case"text":return(0,n.jsx)("input",{type:"text",value:l||"",onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:o});case"number":return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("input",{type:"number",value:"string"==typeof l?l.replace(/[^\d.-]/g,""):"",onChange:e=>x(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded-l-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:o,min:d,max:c,step:p}),u&&(0,n.jsx)("span",{className:"px-2 py-1 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md text-xs text-gray-600 flex items-center",children:u})]});case"color":return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("input",{type:"color",value:l||"#ffffff",onChange:e=>x(e.target.value),className:"w-12 h-8 border border-gray-300 rounded-l-md cursor-pointer","aria-label":i}),(0,n.jsx)("input",{type:"text",value:l||"",onChange:e=>x(e.target.value),className:"flex-1 px-2 py-1 border border-l-0 border-gray-300 rounded-r-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"#ffffff"})]});case"select":var e;return(0,n.jsxs)(f.Root,{value:l||(null==s||null==(e=s[0])?void 0:e.value)||"",onValueChange:e=>x(e),children:[(0,n.jsxs)(f.Trigger,{className:"w-full inline-flex items-center justify-between px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,n.jsx)(f.Value,{}),(0,n.jsx)(f.Icon,{children:(0,n.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,n.jsx)(f.Portal,{children:(0,n.jsx)(f.Content,{className:"bg-white rounded-md shadow-lg border border-gray-200 z-50",children:(0,n.jsx)(f.Viewport,{className:"p-1",children:null==s?void 0:s.map(e=>(0,n.jsxs)(f.Item,{value:e.value,className:"relative flex items-center px-3 py-2 text-sm rounded-sm cursor-pointer select-none hover:bg-gray-100 focus:bg-gray-100 focus:outline-none data-[highlighted]:bg-gray-100",children:[(0,n.jsx)(f.ItemText,{children:e.label}),(0,n.jsx)(f.ItemIndicator,{className:"absolute right-2",children:(0,n.jsx)(v.A,{className:"h-4 w-4"})})]},e.value))})})})]});case"switch":return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(y.bL,{checked:l||!1,onCheckedChange:e=>x(e),className:"w-11 h-6 bg-gray-200 rounded-full relative data-[state=checked]:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,n.jsx)(y.zi,{className:"block w-5 h-5 bg-white rounded-full transition-transform duration-100 translate-x-0.5 will-change-transform data-[state=checked]:translate-x-5"})}),(0,n.jsx)(m.b,{className:"text-sm text-gray-700",children:l?"开启":"关闭"})]});case"textarea":return(0,n.jsx)("textarea",{value:l||"",onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:o,rows:3});case"url":return(0,n.jsx)("input",{type:"url",value:l||"",onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:o||"https://"});default:return null}})()]})}function C(e){let{group:t,values:l,onChange:a}=e,{title:r,controls:i}=t;return(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:r}),(0,n.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,n.jsx)(j,{control:e,value:l[e.key],onChange:t=>a(e.key,t)},e.key))})]})}var N=l(30064);function k(){let{selectedComponentId:e,getComponentById:t,updateComponent:l,currentPage:r,updatePageConfig:o,updatePageSEO:s,updatePageInfo:d}=(0,i.U)(),[c,p]=(0,a.useState)("props"),x=e?t(e):null;if(!x)return(0,n.jsx)("div",{className:"h-full flex flex-col",children:(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium text-gray-900",children:"页面配置"}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:null==r?void 0:r.id})]})]}),(0,n.jsxs)(N.bL,{value:c,onValueChange:e=>p(e),children:[(0,n.jsxs)(N.B8,{className:"flex border-b border-gray-200",children:[(0,n.jsx)(N.l9,{value:"props",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"基本信息"}),(0,n.jsx)(N.l9,{value:"style",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"页面设置"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,n.jsxs)(N.UC,{value:"props",children:[(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"页面信息"}),(0,n.jsx)("div",{className:"space-y-3",children:[{type:"text",label:"页面名称",key:"name",placeholder:"请输入页面名称"},{type:"text",label:"页面标题",key:"title",placeholder:"请输入页面标题"},{type:"textarea",label:"页面描述",key:"description",placeholder:"请输入页面描述"}].map(e=>(0,n.jsx)(j,{control:e,value:null==r?void 0:r[e.key],onChange:t=>d({[e.key]:t})},e.key))})]}),(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"SEO 设置"}),(0,n.jsx)("div",{className:"space-y-3",children:[{type:"text",label:"关键词",key:"keywords",placeholder:"请输入关键词，用逗号分隔"},{type:"text",label:"作者",key:"author",placeholder:"请输入作者信息"},{type:"text",label:"Open Graph 标题",key:"ogTitle",placeholder:"社交媒体分享标题"},{type:"textarea",label:"Open Graph 描述",key:"ogDescription",placeholder:"社交媒体分享描述"}].map(e=>{var t;return(0,n.jsx)(j,{control:e,value:null==r||null==(t=r.seo)?void 0:t[e.key],onChange:t=>s({[e.key]:t})},e.key)})})]})]}),(0,n.jsx)(N.UC,{value:"style",children:(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"页面样式"}),(0,n.jsx)("div",{className:"space-y-3",children:[{type:"color",label:"背景颜色",key:"backgroundColor"},{type:"text",label:"最小高度",key:"minHeight",placeholder:"如：100vh, 600px"},{type:"number",label:"页面内边距",key:"padding",placeholder:"20",min:0,unit:"px"},{type:"select",label:"字体家族",key:"fontFamily",options:[{label:"系统字体",value:"system-ui"},{label:"Arial",value:"Arial"},{label:"Helvetica",value:"Helvetica"}]},{type:"number",label:"默认字体大小",key:"fontSize",placeholder:"14",min:8,max:72,unit:"px"},{type:"text",label:"行高",key:"lineHeight",placeholder:"如：1.6, 24px"},{type:"color",label:"默认文字颜色",key:"color"}].map(e=>{var t;return(0,n.jsx)(j,{control:e,value:null==r||null==(t=r.config)?void 0:t[e.key],onChange:t=>{let l="string"==typeof t?(0,g.iE)(e.key,t):t;o({[e.key]:l})}},e.key)})})]})})]})]})]})});let h=(0,u.VH)(x.type),{propertyConfig:m}=h,f=(t,n)=>{l(e,{props:{...x.props,[t]:n}})},y=(t,n)=>{let a="string"==typeof n?(0,g.iE)(t,n):n;l(e,{style:{...x.style,[t]:a}})};return(0,n.jsx)("div",{className:"h-full flex flex-col",children:(0,n.jsxs)("div",{className:"property-section",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,n.jsx)("span",{className:"text-2xl",children:h.icon}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium text-gray-900",children:h.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:x.id})]})]}),(0,n.jsxs)(N.bL,{value:c,onValueChange:e=>p(e),children:[(0,n.jsxs)(N.B8,{className:"flex border-b border-gray-200",children:[(0,n.jsx)(N.l9,{value:"props",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"属性"}),(0,n.jsx)(N.l9,{value:"style",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"样式"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,n.jsx)(N.UC,{value:"props",children:m.props&&m.props.length>0?m.props.map(e=>(0,n.jsx)(C,{group:e,values:x.props,onChange:f},e.key)):(0,n.jsx)("div",{className:"property-section",children:(0,n.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"此组件没有可配置的属性"})})}),(0,n.jsx)(N.UC,{value:"style",children:m.styles&&m.styles.length>0?m.styles.map(e=>(0,n.jsx)(C,{group:e,values:x.style||{},onChange:y},e.key)):(0,n.jsx)("div",{className:"property-section",children:(0,n.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"此组件没有可配置的样式"})})})]})]})]})},e)}l(15495);var w=l(57434),S=l(62158),L=l(27213),R=l(89917),T=l(48293),A=l(15968),z=l(81586),D=l(87712),H=l(96042);w.A,S.A,L.A,R.A,T.A,A.A,z.A,D.A,H.A;var E=l(55028),P=l(48021),B=l(13052),O=l(54416),M=l(47924);let V={text:w.A,button:S.A,image:L.A,input:R.A,container:T.A,list:A.A,card:z.A,divider:D.A,space:H.A};function U(e){let{node:t,onSelect:l,onDelete:a,onToggleExpanded:r,onMove:i,isSelected:o}=e,s=(0,u.AV)(t.type),d=V[t.type]||w.A,c=t.children.length>0,{attributes:g,listeners:x,setNodeRef:h,isDragging:m}=(0,p.PM)({id:"tree-node-".concat(t.id),data:{type:"tree-node",nodeId:t.id,node:t}}),{isOver:f,setNodeRef:y}=(0,p.zM)({id:"tree-drop-before-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"before",canHaveChildren:s.canHaveChildren}}),{isOver:v,setNodeRef:j}=(0,p.zM)({id:"tree-drop-inside-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"inside",canHaveChildren:s.canHaveChildren},disabled:!s.canHaveChildren}),{isOver:C,setNodeRef:N}=(0,p.zM)({id:"tree-drop-after-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"after",canHaveChildren:s.canHaveChildren}});return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:y,className:"h-1 ".concat(f?"bg-blue-400":"")}),(0,n.jsxs)("div",{ref:h,className:"group flex items-center py-1 px-2 cursor-pointer hover:bg-gray-50 ".concat(o?"bg-blue-100 text-blue-800":""," ").concat(m?"opacity-50":""," ").concat(v&&s.canHaveChildren?"bg-green-50 border-l-2 border-green-400":""),style:{paddingLeft:"".concat(16*t.depth+8,"px")},onClick:()=>{l(t.id)},children:[(0,n.jsx)("div",{...g,...x,className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 rounded mr-1 cursor-grab active:cursor-grabbing",children:(0,n.jsx)(P.A,{className:"h-3 w-3 text-gray-400"})}),c?(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),r(t.id)},className:"p-0.5 hover:bg-gray-200 rounded mr-1",children:t.isExpanded?(0,n.jsx)(b.A,{className:"h-3 w-3"}):(0,n.jsx)(B.A,{className:"h-3 w-3"})}):(0,n.jsx)("div",{className:"w-4 mr-1"}),(0,n.jsx)(d,{className:"h-4 w-4 mr-2 text-gray-500"}),(0,n.jsx)("span",{ref:s.canHaveChildren?j:void 0,className:"text-sm flex-1 truncate",children:t.name||s.name}),s.canHaveChildren&&(0,n.jsx)("span",{className:"text-xs px-1 py-0.5 bg-green-100 text-green-700 rounded text-[10px] mr-1",children:"容器"}),!t.isVisible&&(0,n.jsx)("span",{className:"text-xs px-1 py-0.5 bg-gray-100 text-gray-600 rounded text-[10px] mr-1",children:"隐藏"}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),a(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-100 hover:text-red-600 rounded","aria-label":"删除组件",children:(0,n.jsx)(O.A,{className:"h-3 w-3"})})]}),c&&t.isExpanded&&(0,n.jsx)("div",{children:t.children.map(e=>(0,n.jsx)(U,{node:e,onSelect:l,onDelete:a,onToggleExpanded:r,onMove:i,isSelected:o},e.id))}),(0,n.jsx)("div",{ref:N,className:"h-1 ".concat(C?"bg-blue-400":"")})]})}function F(){let{getTreeNodes:e,selectedComponentId:t,selectComponent:l,deleteComponent:r,toggleNodeExpanded:o,moveComponent:s,treeManager:d}=(0,i.U)(),[c,p]=(0,a.useState)(""),u=e();(0,a.useEffect)(()=>{console.log("TreeViewV2: 树节点更新",{nodeCount:u.length,nodes:u.map(e=>({id:e.id,name:e.name,type:e.type})),treeManagerExists:!!d})},[u,d]);let g=(0,a.useMemo)(()=>{if(!c)return u;let e=t=>t.reduce((t,l)=>{if(l.name.toLowerCase().includes(c.toLowerCase())||l.type.toLowerCase().includes(c.toLowerCase()))t.push(l);else if(l.children.length>0){let n=e(l.children);n.length>0&&t.push({...l,children:n,isExpanded:!0})}return t},[]);return e(u)},[u,c]),x=e=>{l(e)},h=t=>{console.log("TreeViewV2: 删除组件",t),console.log("TreeViewV2: 删除前节点数量",u.length),r(t),setTimeout(()=>{console.log("TreeViewV2: 删除后节点数量",e().length)},100)},m=e=>{o(e)},f=(e,t,l)=>{console.log("TreeViewV2: 移动组件",{dragId:e,hoverId:t,position:l}),s(e,t,l)};return 0===u.length?(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsx)("div",{className:"p-3 border-b",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(M.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,n.jsx)("input",{type:"text",placeholder:"搜索组件...",value:c,onChange:e=>p(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500 py-8",children:[(0,n.jsx)("div",{className:"text-4xl mb-3",children:"\uD83C\uDF33"}),(0,n.jsx)("p",{className:"text-sm",children:"暂无组件"}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"拖拽组件到画布开始编辑"})]})]}):(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsx)("div",{className:"p-3 border-b",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(M.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,n.jsx)("input",{type:"text",placeholder:"搜索组件...",value:c,onChange:e=>p(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),(0,n.jsx)("div",{className:"px-3 py-2 bg-blue-50 border-b text-xs text-blue-700",children:"\uD83D\uDCA1 单击选中，箭头展开/收起，拖拽手柄重新排序，支持搜索过滤"}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:g.map(e=>(0,n.jsx)(U,{node:e,onSelect:x,onDelete:h,onToggleExpanded:m,onMove:f,isSelected:t===e.id},e.id))})]})}let I=(0,E.default)(()=>Promise.resolve().then(l.bind(l,99220)).then(e=>e.MaterialPanel),{loadableGenerated:{webpack:()=>[99220]},ssr:!1,loading:()=>(0,n.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 px-2 py-1 bg-gray-100 rounded",children:"\uD83D\uDD04 正在加載組件庫..."}),Array.from({length:10},(e,t)=>(0,n.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))]})});function _(){return(0,n.jsx)("div",{className:"w-80 border-r border-gray-200 bg-white flex flex-col",children:(0,n.jsxs)(N.bL,{defaultValue:"materials",className:"flex flex-col h-full",children:[(0,n.jsxs)(N.B8,{className:"flex border-b border-gray-200","aria-label":"左侧面板选项",children:[(0,n.jsxs)(N.l9,{value:"materials",className:" flex-1 px-4 py-3 text-sm font-medium text-center transition-colors text-gray-500 hover:text-gray-700 hover:bg-gray-50 data-[state=active]:text-blue-600 data-[state=active]:border-b-2  data-[state=active]:border-blue-600 data-[state=active]:bg-blue-50 ",children:[(0,n.jsx)("span",{className:"mr-2",children:"\uD83E\uDDE9"}),"组件库"]}),(0,n.jsxs)(N.l9,{value:"tree",className:" flex-1 px-4 py-3 text-sm font-medium text-center transition-colors text-gray-500 hover:text-gray-700 hover:bg-gray-50 data-[state=active]:text-blue-600 data-[state=active]:border-b-2  data-[state=active]:border-blue-600 data-[state=active]:bg-blue-50 ",children:[(0,n.jsx)("span",{className:"mr-2",children:"\uD83C\uDF33"}),"组件树"]})]}),(0,n.jsx)(N.UC,{value:"materials",className:"flex-1 overflow-hidden focus:outline-none",children:(0,n.jsx)("div",{className:"h-full p-4 overflow-y-auto",children:(0,n.jsx)(I,{})})}),(0,n.jsx)(N.UC,{value:"tree",className:"flex-1 overflow-hidden focus:outline-none",children:(0,n.jsx)("div",{className:"h-full overflow-y-auto",children:(0,n.jsx)(F,{})})})]})})}var Z=l(85996),W=l(82502),q=l(48956);let G=[{id:"comp_1",type:"text",name:"标题文本",props:{text:"欢迎使用H5低代码编辑器"},style:{fontSize:"24px",fontWeight:"bold",color:"#333333",textAlign:"center",paddingTop:"20px",paddingBottom:"20px",paddingLeft:"20px",paddingRight:"20px",marginTop:"10px",marginBottom:"10px",marginLeft:"0px",marginRight:"0px"}},{id:"comp_2",type:"button",name:"主要按钮",props:{text:"开始体验"},style:{backgroundColor:"#1890ff",color:"#ffffff",paddingTop:"12px",paddingBottom:"12px",paddingLeft:"24px",paddingRight:"24px",borderRadius:"6px",fontSize:"16px",marginTop:"20px",marginBottom:"20px",marginLeft:"auto",marginRight:"auto",display:"block",width:"200px"}}],J={id:"page_1",name:"首页",title:"示例页面",description:"这是一个示例页面",config:{backgroundColor:"#ffffff",minHeight:"100vh",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",lineHeight:"1.6",color:"#333333"},seo:{keywords:"H5, 低代码, 编辑器",author:"H5 Editor",ogTitle:"示例页面",ogDescription:"这是一个H5低代码编辑器生成的示例页面"},components:G,createdAt:new Date("2024-01-01T00:00:00Z"),updatedAt:new Date("2024-01-01T00:00:00Z")},K={id:"project_1",name:"示例项目",description:"H5低代码编辑器示例项目",pages:[J],createdAt:new Date("2024-01-01T00:00:00Z"),updatedAt:new Date("2024-01-01T00:00:00Z")};function Y(){return{project:K,page:J,components:G}}function X(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)().get("pageId"),{setCurrentPage:l,addComponent:o,moveComponent:s}=(0,i.U)(),{getPageById:d}=(0,q.s)(),c=(0,p.FR)((0,p.MS)(p.AN,{activationConstraint:{distance:8}}));return(0,a.useEffect)(()=>{requestAnimationFrame(async()=>{try{if(await (0,u.tx)(),t){let n=d(t);n?l(n):e.push("/")}else{let{page:e}=Y();l(e)}}catch(n){if(console.error("編輯器初始化失敗:",n),t){let n=d(t);n?l(n):e.push("/")}else{let{page:e}=Y();l(e)}}})},[t,l,d,e]),(0,n.jsx)(p.Mp,{sensors:c,collisionDetection:p.fp,onDragEnd:e=>{var t,l,n;let{active:a,over:r}=e;if(r){if((null==(t=a.data.current)?void 0:t.type)==="material"){let e=a.data.current.config,t={id:"comp_".concat(Date.now()),type:e.type,name:e.name,props:e.defaultProps,style:e.defaultStyle};"canvas-drop-zone"===r.id?o(t):"string"==typeof r.id&&r.id.startsWith("component-")&&o(t,r.id.replace("component-",""))}else if((null==(l=a.data.current)?void 0:l.type)==="tree-node"&&(null==(n=r.data.current)?void 0:n.type)==="tree-drop"){let e=a.data.current.nodeId,t=r.data.current.nodeId,l=r.data.current.position;e!==t&&s(e,t,l)}}},children:(0,n.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,n.jsx)(Z.M,{}),(0,n.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,n.jsx)(_,{}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center p-8 overflow-auto",children:(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(W.Mj,{title:"页面编辑",children:(0,n.jsx)(h,{})})})}),(0,n.jsx)("div",{className:"w-[420px] property-panel overflow-y-auto",children:(0,n.jsx)(k,{})})]})]})})}function Q(){return(0,n.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"正在加载编辑器..."})]})})}function $(){return(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)(Q,{}),children:(0,n.jsx)(X,{})})}},60701:(e,t,l)=>{"use strict";l.r(t),l.d(t,{inputConfig:()=>n});let n={id:"input",type:"input",name:"输入框",icon:"\uD83D\uDCDD",defaultProps:{placeholder:"请输入内容",type:"text"},defaultStyle:{width:"100%",paddingTop:"8",paddingRight:"12",paddingBottom:"8",paddingLeft:"12",border:"1px solid #d9d9d9",borderRadius:"4",fontSize:"14",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!1,description:"用于用户输入",propertyConfig:{props:[{title:"输入框",key:"input",controls:[{type:"text",label:"占位符",key:"placeholder",placeholder:"请输入占位符文本"},{type:"select",label:"输入类型",key:"type",options:[{label:"文本",value:"text"},{label:"密码",value:"password"},{label:"邮箱",value:"email"},{label:"数字",value:"number"},{label:"电话",value:"tel"}]}]}],styles:l(14285).N}}},60899:(e,t,l)=>{"use strict";l.r(t),l.d(t,{buttonConfig:()=>n});let n={id:"button",type:"button",name:"按钮",icon:"\uD83D\uDD18",defaultProps:{text:"按钮"},defaultStyle:{backgroundColor:"#1890ff",color:"#ffffff",paddingTop:"8",paddingRight:"16",paddingBottom:"8",paddingLeft:"16",borderRadius:"4",border:"none",fontSize:"14",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!1,description:"可点击的按钮组件",propertyConfig:{props:[{title:"内容",key:"content",controls:[{type:"text",label:"按钮文字",key:"text",placeholder:"请输入按钮文字"}]},{title:"状态",key:"state",controls:[{type:"switch",label:"禁用状态",key:"disabled"}]}],styles:l(14285).N}}},65420:(e,t,l)=>{Promise.resolve().then(l.bind(l,44311))},66396:(e,t,l)=>{"use strict";l.r(t),l.d(t,{containerConfig:()=>a});var n=l(14285);let a={id:"container",type:"container",name:"容器",icon:"\uD83D\uDCE6",defaultProps:{},defaultStyle:{paddingTop:"16",paddingRight:"16",paddingBottom:"16",paddingLeft:"16",backgroundColor:"#f5f5f5",borderRadius:"4",display:"flex",flexDirection:"column",gap:"8",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!0,description:"用于包含其他组件的容器",propertyConfig:{props:[],styles:[...n.N,...n.w]}}},71825:(e,t,l)=>{"use strict";l.r(t),l.d(t,{cardConfig:()=>n});let n={id:"card",type:"card",name:"卡片",icon:"\uD83C\uDFB4",defaultProps:{},defaultStyle:{backgroundColor:"#ffffff",border:"1px solid #e8e8e8",borderRadius:"8",paddingTop:"16",paddingRight:"16",paddingBottom:"16",paddingLeft:"16",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!0,description:"卡片容器组件",propertyConfig:{props:[],styles:l(14285).N}}},75163:(e,t,l)=>{"use strict";l.r(t),l.d(t,{spaceConfig:()=>n});let n={id:"space",type:"space",name:"间距",icon:"⬜",defaultProps:{},defaultStyle:{width:"100%",height:"16",marginTop:"0",marginRight:"0",marginBottom:"0",marginLeft:"0"},canHaveChildren:!1,description:"用于增加组件间距",propertyConfig:{props:[],styles:[{title:"尺寸",key:"size",controls:[{type:"number",label:"宽度",key:"width",placeholder:"100%",min:0},{type:"number",label:"高度",key:"height",placeholder:"16",min:1,unit:"px"}]}]}}},85996:(e,t,l)=>{"use strict";l.d(t,{o:()=>f,M:()=>h});var n=l(95155),a=l(10068),r=l(82502),i=l(61827),o=l(62978),s=l(89613),d=l(93654),c=l(48932),p=l(92657),u=l(4229),g=l(48587),x=l(12115);function h(){let[e,t]=(0,x.useState)(!1),l=(0,i.dj)(),{openPreview:h}=(0,o.bR)(),m=(0,o.f3)(),{canUndo:f,canRedo:y,undo:b,redo:v,precompileStyles:j,currentPage:C}=(0,a.U)(),N=(0,o.g0)(),k=async()=>{try{if(l.loading("正在准备预览...",1e3),!m())return void l.error("保存失敗，無法預覽");j(),await new Promise(e=>setTimeout(e,800)),h(null==C?void 0:C.id)}catch(e){l.error("预览失败"),console.error("预览失败:",e)}};return(0,n.jsxs)(s.Kq,{children:[(0,n.jsxs)("div",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"H5 Low Code Editor"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:(null==C?void 0:C.name)||"未命名项目"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(r.sM,{showTooltip:!0}),(0,n.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,n.jsxs)(s.bL,{children:[(0,n.jsx)(s.l9,{asChild:!0,children:(0,n.jsxs)("button",{onClick:b,disabled:!f(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,n.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"撤销"]})}),(0,n.jsx)(s.ZL,{children:(0,n.jsxs)(s.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["撤销 (Ctrl+Z)",(0,n.jsx)(s.i3,{className:"fill-gray-900"})]})})]}),(0,n.jsxs)(s.bL,{children:[(0,n.jsx)(s.l9,{asChild:!0,children:(0,n.jsxs)("button",{onClick:v,disabled:!y(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,n.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"重做"]})}),(0,n.jsx)(s.ZL,{children:(0,n.jsxs)(s.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["重做 (Ctrl+Y)",(0,n.jsx)(s.i3,{className:"fill-gray-900"})]})})]}),(0,n.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,n.jsxs)(s.bL,{children:[(0,n.jsx)(s.l9,{asChild:!0,children:(0,n.jsxs)("button",{onClick:k,className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,n.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"预览"]})}),(0,n.jsx)(s.ZL,{children:(0,n.jsxs)(s.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览页面",(0,n.jsx)(s.i3,{className:"fill-gray-900"})]})})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)(s.bL,{children:[(0,n.jsx)(s.l9,{asChild:!0,children:(0,n.jsxs)("button",{onClick:()=>{m()?l.success("頁面已保存"):l.error("保存失敗，請重試")},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,n.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"保存"]})}),(0,n.jsx)(s.ZL,{children:(0,n.jsxs)(s.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["保存项目",(0,n.jsx)(s.i3,{className:"fill-gray-900"})]})})]}),(0,n.jsx)(s.bL,{children:(0,n.jsx)(s.l9,{asChild:!0,children:(0,n.jsxs)("button",{onClick:()=>{try{if(!N)return void l.error("没有可导出的页面");l.loading("生成导出中",2e3),setTimeout(()=>{t(!0)},2e3)}catch(e){l.error("JSON 预览失败"),console.error("JSON 预览失败:",e)}},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-green-500 hover:bg-green-600 text-white rounded-md transition-colors",children:[(0,n.jsx)(g.A,{className:"h-4 w-4 mr-1"}),"导出"]})})})]})]}),(0,n.jsx)(i.zZ,{open:e,onOpenChange:t,page:N,title:"JSON Schema 预览"})]})}var m=l(66766);function f(e){let{component:t,pageConfig:l}=e,{className:a}=t,{type:r,style:i}=t,o={};i&&Object.entries(i).forEach(e=>{let[t,l]=e;l&&(o[t]=l)});let s={};l&&(!o.fontFamily&&l.fontFamily&&(s.fontFamily=l.fontFamily),!o.fontSize&&l.fontSize&&(s.fontSize=l.fontSize),!o.lineHeight&&l.lineHeight&&(s.lineHeight=l.lineHeight),!o.color&&l.color&&(s.color=l.color));let d={...s,...o,boxSizing:"border-box"};switch(r){case"text":return(0,n.jsx)("span",{className:a,style:d,children:t.props.text||"文本内容"});case"button":return(0,n.jsx)("button",{className:"".concat(a," ").concat(a?"":"px-4 py-2 rounded hover:opacity-80 disabled:opacity-50"),style:d,disabled:t.props.disabled,children:t.props.text||"按钮"});case"image":return(0,n.jsx)(m.default,{style:d,src:t.props.src||"https://via.placeholder.com/200x150?text=图片",alt:t.props.alt||"图片",width:200,height:150},t.id);case"input":return(0,n.jsx)("input",{className:"".concat(a," ").concat(a?"":"px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"),style:d,type:t.props.type||"text",placeholder:t.props.placeholder||"请输入内容",readOnly:!0});case"container":return(0,n.jsx)("div",{className:"".concat(a," ").concat(a?"":"min-h-[50px]"),style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,n.jsx)(f,{component:e,pageConfig:l},e.id)):(0,n.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空容器"})});case"list":return(0,n.jsx)("div",{className:a,style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,n.jsx)(f,{component:e,pageConfig:l},e.id)):(0,n.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空列表"})});case"card":return(0,n.jsx)("div",{className:"".concat(a," ").concat(a?"":"bg-white rounded-lg shadow border"),style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,n.jsx)(f,{component:e,pageConfig:l},e.id)):(0,n.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空卡片"})});case"divider":return(0,n.jsx)("div",{className:"".concat(a," ").concat(a?"":"border-t border-gray-300"),style:d});case"space":return(0,n.jsx)("div",{className:a,style:d});default:return(0,n.jsxs)("div",{className:a,style:d,children:["未知组件类型: ",r]})}}},99220:(e,t,l)=>{"use strict";l.r(t),l.d(t,{MaterialPanel:()=>c});var n=l(95155),a=l(12115),r=l(33934),i=l(10068),o=l(89613),s=l(25472);let d=(0,a.memo)(function(e){let{config:t,onAddComponent:l,index:r}=e,i="material-".concat(t.type,"-").concat(r),{attributes:d,listeners:c,setNodeRef:p,transform:u,isDragging:g}=(0,s.PM)({id:i,data:{type:"material",config:t}}),x=(0,a.useCallback)(()=>{l(t)},[t,l]),h={transform:u?"translate3d(".concat(u.x,"px, ").concat(u.y,"px, 0)"):void 0,opacity:g?.5:1};return(0,n.jsxs)(o.bL,{children:[(0,n.jsx)(o.l9,{asChild:!0,children:(0,n.jsx)("button",{ref:p,style:h,...d,...c,onClick:x,className:"material-item w-full text-left cursor-grab active:cursor-grabbing hover:bg-gray-50 transition-colors","aria-label":"添加".concat(t.name,"組件"),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3 p-2 rounded-lg",children:[(0,n.jsx)("span",{className:"text-2xl",children:t.icon}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:t.name}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t.description})]}),t.canHaveChildren&&(0,n.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded",children:"容器"})]})})}),(0,n.jsx)(o.ZL,{children:(0,n.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:[t.canHaveChildren?"拖拽到畫布或點擊添加容器組件":"拖拽到畫布或點擊添加組件",(0,n.jsx)(o.i3,{className:"fill-gray-900"})]})})]})}),c=(0,a.memo)(function(){let[e,t]=(0,a.useState)([]),[l,s]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{if(console.log("\uD83D\uDD27 MaterialPanel: 開始初始化組件系統..."),await (0,r.tx)(),e){let e=(0,r.uk)();console.log("✅ MaterialPanel: 組件初始化完成，獲取到",e.length,"個組件"),t(e),s(!0)}}catch(t){console.error("❌ MaterialPanel: 組件初始化失敗:",t),e&&s(!0)}})(),()=>{e=!1}},[]);let c=(0,a.useCallback)(e=>{let t={id:"comp_".concat(Date.now()),type:e.type,name:e.name,props:e.defaultProps,style:e.defaultStyle};i.U.getState().addComponent(t)},[]);return l?0===e.length?(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsx)("div",{className:"text-xs text-red-500 px-2 py-1 bg-red-50 rounded",children:"⚠️ 組件庫加載失敗，請刷新頁面重試"})}):(0,n.jsx)(o.Kq,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"text-xs text-gray-500 px-2 py-1 bg-blue-50 rounded",children:"\uD83D\uDCA1 點擊添加到頁面，或拖拽到容器中"}),e.map((e,t)=>(0,n.jsx)(d,{config:e,onAddComponent:c,index:t},e.id))]})}):(0,n.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 px-2 py-1 bg-gray-100 rounded",children:"\uD83D\uDD04 正在加載組件庫..."}),Array.from({length:10},(e,t)=>(0,n.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[493,277,861,407,858,887,999,18,827,502,441,684,358],()=>t(65420)),_N_E=e.O()}]);