(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[766],{14285:(e,t,l)=>{"use strict";l.d(t,{N:()=>a,w:()=>n});let a=[{title:"尺寸",key:"size",controls:[{type:"number",label:"宽度",key:"width",placeholder:"auto",min:0,unit:"px"},{type:"number",label:"高度",key:"height",placeholder:"auto",min:0,unit:"px"}]},{title:"外边距",key:"margin",controls:[{type:"number",label:"上",key:"marginTop",placeholder:"0",min:0,unit:"px"},{type:"number",label:"右",key:"marginRight",placeholder:"0",min:0,unit:"px"},{type:"number",label:"下",key:"marginBottom",placeholder:"0",min:0,unit:"px"},{type:"number",label:"左",key:"marginLeft",placeholder:"0",min:0,unit:"px"}]},{title:"内边距",key:"padding",controls:[{type:"number",label:"上",key:"paddingTop",placeholder:"0",min:0,unit:"px"},{type:"number",label:"右",key:"paddingRight",placeholder:"0",min:0,unit:"px"},{type:"number",label:"下",key:"paddingBottom",placeholder:"0",min:0,unit:"px"},{type:"number",label:"左",key:"paddingLeft",placeholder:"0",min:0,unit:"px"}]},{title:"颜色",key:"color",controls:[{type:"color",label:"文字颜色",key:"color"},{type:"color",label:"背景颜色",key:"backgroundColor"}]},{title:"字体",key:"font",controls:[{type:"number",label:"字体大小",key:"fontSize",placeholder:"14",min:1,max:200,unit:"px"},{type:"select",label:"字体粗细",key:"fontWeight",options:[{label:"正常",value:"normal"},{label:"粗体",value:"bold"},{label:"细体",value:"lighter"}]}]},{title:"边框",key:"border",controls:[{type:"number",label:"边框宽度",key:"borderWidth",placeholder:"0",min:0,max:50,unit:"px"},{type:"select",label:"边框样式",key:"borderStyle",options:[{label:"实线",value:"solid"},{label:"虚线",value:"dashed"},{label:"点线",value:"dotted"}]},{type:"color",label:"边框颜色",key:"borderColor"},{type:"number",label:"圆角",key:"borderRadius",placeholder:"0",min:0,max:100,unit:"px"}]}],n=[{title:"布局",key:"layout",controls:[{type:"select",label:"显示方式",key:"display",options:[{label:"块级",value:"block"},{label:"弹性",value:"flex"},{label:"网格",value:"grid"},{label:"隐藏",value:"none"}]},{type:"select",label:"弹性方向",key:"flexDirection",options:[{label:"横向",value:"row"},{label:"纵向",value:"column"}]},{type:"select",label:"主轴对齐",key:"justifyContent",options:[{label:"开始",value:"flex-start"},{label:"居中",value:"center"},{label:"结束",value:"flex-end"},{label:"空间分布",value:"space-between"},{label:"环绕分布",value:"space-around"}]},{type:"select",label:"交叉轴对齐",key:"alignItems",options:[{label:"开始",value:"flex-start"},{label:"居中",value:"center"},{label:"结束",value:"flex-end"},{label:"拉伸",value:"stretch"}]},{type:"number",label:"间距",key:"gap",placeholder:"0",min:0,unit:"px"}]}]},26575:(e,t,l)=>{"use strict";l.d(t,{s:()=>s});var a=l(88693),n=l(46786);let r=()=>"page_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s=(0,a.vt)()((0,n.Zr)((e,t)=>({pages:[],createPage:(l,a,n)=>{let{pages:s}=t(),i={id:r(),name:l,title:a,description:n,components:[],createdAt:new Date,updatedAt:new Date};return e({pages:[...s,i]}),i},updatePage:(l,a)=>{let{pages:n}=t();e({pages:n.map(e=>e.id===l?{...e,...a,updatedAt:new Date}:e)})},deletePage:l=>{let{pages:a}=t();e({pages:a.filter(e=>e.id!==l)})},getPageById:e=>{let{pages:l}=t();return l.find(t=>t.id===e)||null},duplicatePage:l=>{let{pages:a}=t(),n=a.find(e=>e.id===l);if(!n)return null;let s={...n,id:r(),name:"".concat(n.name," 副本"),title:"".concat(n.title," 副本"),createdAt:new Date,updatedAt:new Date};return e({pages:[...a,s]}),s},generatePageId:r}),{name:"pages-storage",version:1}))},33934:(e,t,l)=>{"use strict";l.d(t,{uk:()=>u,AV:()=>d,VH:()=>s,tx:()=>o}),l(14285);class a{register(e,t,l){this.registry[e]&&console.warn("Component ".concat(e," is already registered. Overriding...")),this.registry[e]={category:t,config:l},this._allComponentsCache=null,this.categories.has(t)||this.categories.set(t,[]);let a=this.categories.get(t);a.includes(e)||a.push(e),console.log("✅ Component '".concat(e,"' registered in category '").concat(t,"'"))}registerBatch(e){e.forEach(e=>{let{type:t,category:l,config:a}=e;this.register(t,l,a)})}getComponent(e){let t=this.registry[e];return t?t.config:null}getAllComponents(){if(this._allComponentsCache&&this._componentsCacheVersion===Object.keys(this.registry).length)return this._allComponentsCache;let e={};return Object.keys(this.registry).forEach(t=>{e[t]=this.registry[t].config}),this._allComponentsCache=e,this._componentsCacheVersion=Object.keys(this.registry).length,e}getComponentsByCategory(e){let t={};return(this.categories.get(e)||[]).forEach(e=>{let l=this.registry[e];l&&(t[e]=l.config)}),t}getCategories(){return Array.from(this.categories.keys())}getStats(){let e={};return this.categories.forEach((t,l)=>{e[l]=t.length}),{total:Object.keys(this.registry).length,byCategory:e}}hasComponent(e){return void 0!==this.registry[e]}unregister(e){let t=this.registry[e];if(!t)return!1;let l=this.categories.get(t.category);if(l){let t=l.indexOf(e);t>-1&&l.splice(t,1)}return delete this.registry[e],console.log("\uD83D\uDDD1️ Component '".concat(e,"' unregistered")),!0}clear(){this.registry={},this.categories.clear(),console.log("\uD83E\uDDF9 All components cleared")}debug(){console.group("\uD83D\uDD0D Component Registry Debug Info"),console.log("Total components:",Object.keys(this.registry).length),console.log("Categories:",Array.from(this.categories.keys())),this.categories.forEach((e,t)=>{console.log("\uD83D\uDCC1 ".concat(t,":"),e)}),console.groupEnd()}constructor(){this.registry={},this.categories=new Map,this._allComponentsCache=null,this._componentsCacheVersion=0}}let n=new a;async function r(){console.log("\uD83D\uDE80 Starting component auto-registration...");try{let e=await Promise.all([l.e(234).then(l.bind(l,3234)).then(e=>({type:"text",category:"basic",config:e.textConfig})),l.e(899).then(l.bind(l,60899)).then(e=>({type:"button",category:"basic",config:e.buttonConfig})),l.e(406).then(l.bind(l,19406)).then(e=>({type:"image",category:"basic",config:e.imageConfig}))]),t=await Promise.all([l.e(701).then(l.bind(l,60701)).then(e=>({type:"input",category:"form",config:e.inputConfig}))]),a=await Promise.all([l.e(396).then(l.bind(l,66396)).then(e=>({type:"container",category:"layout",config:e.containerConfig})),l.e(825).then(l.bind(l,71825)).then(e=>({type:"card",category:"layout",config:e.cardConfig})),l.e(582).then(l.bind(l,6582)).then(e=>({type:"divider",category:"layout",config:e.dividerConfig})),l.e(163).then(l.bind(l,75163)).then(e=>({type:"space",category:"layout",config:e.spaceConfig}))]),r=await Promise.all([l.e(493).then(l.bind(l,43493)).then(e=>({type:"list",category:"data",config:e.listConfig}))]);n.registerBatch([...e,...t,...a,...r]),console.log("✅ Component auto-registration completed"),n.debug()}catch(e){console.error("❌ Component auto-registration failed:",e)}}function s(e){let t=n.getComponent(e);if(!t)throw Error("Unknown component type: ".concat(e));return t}let i=!1;async function o(){i||(console.log("\uD83D\uDD27 Initializing component system..."),await r(),i=!0,console.log("✅ Component system initialized"))}function d(e){let t=n.getComponent(e);if(!t)throw Error("Unknown component type: ".concat(e));return t}let c=null,p=0;function u(){let e=n.getAllComponents(),t=Object.keys(e).length;return c&&p===t||(c=Object.values(e),p=t),c}o().catch(e=>{console.warn("⚠️ Component system initialization failed:",e)})},44311:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>Q});var a=l(95155),n=l(12115),r=l(35695),s=l(10068),i=l(66766),o=l(47650),d=l(89613);function c(e){let{children:t,componentId:l,isSelected:r,componentName:i}=e,{deleteComponent:c}=(0,s.U)(),p=(0,n.useRef)(null),[u,x]=(0,n.useState)({top:0,left:0,visible:!1,isScrolling:!1}),g=(0,n.useRef)(),[h]=(0,n.useState)(!0),m=(0,n.useCallback)(()=>{if(!r||!p.current)return void x(e=>({...e,visible:!1}));let e=p.current.getBoundingClientRect(),t=e.top-32-6,l=e.left,a=globalThis.innerHeight,n=globalThis.innerWidth;t<10&&(t=e.bottom+6),t+32>a-10&&(t=e.top+6),l+180>n-10&&(l=Math.max(10,n-180-10)),x(e=>({top:t,left:l,visible:!e.isScrolling,isScrolling:e.isScrolling}))},[r]),f=(0,n.useCallback)(()=>{x(e=>({...e,isScrolling:!0,visible:!1})),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{x(e=>({...e,isScrolling:!1})),m()},300)},[m]);return(0,n.useEffect)(()=>{r?m():x(e=>({...e,visible:!1}))},[r,m]),(0,n.useEffect)(()=>{var e,t;if(!r)return;let l=[window,document.querySelector(".overflow-y-auto"),document.querySelector(".overflow-auto"),null==(e=p.current)?void 0:e.closest(".overflow-y-auto"),null==(t=p.current)?void 0:t.closest(".overflow-auto")].filter(Boolean);return l.forEach(e=>{null==e||e.addEventListener("scroll",f,{passive:!0})}),globalThis.addEventListener("resize",m,{passive:!0}),()=>{l.forEach(e=>{null==e||e.removeEventListener("scroll",f)}),globalThis.removeEventListener("resize",m),g.current&&clearTimeout(g.current)}},[r,f,m]),(0,a.jsxs)("div",{ref:p,className:"relative group",children:[t,r&&!u.isScrolling&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"absolute inset-0 border border-blue-500 rounded-sm pointer-events-none z-10 shadow-sm",children:[(0,a.jsx)("div",{className:"absolute -top-0.5 -left-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,a.jsx)("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,a.jsx)("div",{className:"absolute -bottom-0.5 -left-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"}),(0,a.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-1.5 h-1.5 bg-blue-500 rounded-full"})]})}),u.visible&&h?(0,o.createPortal)((0,a.jsx)("div",{className:"fixed flex items-center space-x-1 bg-blue-500 rounded-md px-2 py-1 shadow-lg pointer-events-auto transition-opacity duration-200",style:{top:"".concat(u.top,"px"),left:"".concat(u.left,"px"),zIndex:9999},children:(0,a.jsxs)(d.Kq,{children:[(0,a.jsx)("span",{className:"text-xs text-white font-medium mr-1",children:i||"组件"}),(0,a.jsxs)(d.bL,{children:[(0,a.jsx)(d.l9,{asChild:!0,children:(0,a.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-blue-600 rounded transition-colors","aria-label":"复制组件",children:(0,a.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})}),(0,a.jsx)(d.ZL,{children:(0,a.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["复制组件",(0,a.jsx)(d.i3,{className:"fill-gray-900"})]})})]}),(0,a.jsxs)(d.bL,{children:[(0,a.jsx)(d.l9,{asChild:!0,children:(0,a.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-blue-600 rounded transition-colors","aria-label":"移动组件",children:(0,a.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})})}),(0,a.jsx)(d.ZL,{children:(0,a.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["移动组件",(0,a.jsx)(d.i3,{className:"fill-gray-900"})]})})]}),(0,a.jsxs)(d.bL,{children:[(0,a.jsx)(d.l9,{asChild:!0,children:(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),c(l)},className:"w-6 h-6 flex items-center justify-center text-white hover:bg-red-500 rounded transition-colors","aria-label":"删除组件",children:(0,a.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),(0,a.jsx)(d.ZL,{children:(0,a.jsxs)(d.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["删除组件",(0,a.jsx)(d.i3,{className:"fill-gray-900"})]})})]})]})}),document.body):null]})}var p=l(25472),u=l(33934),x=l(53999);function g(e){let{component:t,isSelected:l,onSelect:n,mode:r="editor"}=e,{type:o,props:d,style:h,children:m}=t,{selectedComponentId:f,selectComponent:y,currentPage:b}=(0,s.U)(),v=(0,u.AV)(o),{isOver:j,setNodeRef:N}=(0,p.zM)({id:"component-".concat(t.id),disabled:!v.canHaveChildren||"editor"!==r,data:{type:"container",componentId:t.id}}),C=e=>{e.stopPropagation(),"editor"===r&&n()},w=()=>{if("editor"===r){let e={};h&&Object.entries(h).forEach(t=>{let[l,a]=t;a&&(e[l]=(0,x.iE)(l,a))});let t={},l=null==b?void 0:b.config;l&&(!e.fontFamily&&l.fontFamily&&(t.fontFamily=l.fontFamily),!e.fontSize&&l.fontSize&&(t.fontSize=l.fontSize),!e.lineHeight&&l.lineHeight&&(t.lineHeight=l.lineHeight),!e.color&&l.color&&(t.color=l.color));let n={cursor:"pointer",transition:"all 0.2s",...t,...e};switch(o){case"text":return(0,a.jsx)("span",{style:n,onClick:C,children:d.text||"文本内容"});case"button":return(0,a.jsx)("button",{style:{...n,paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"0px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"0px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"0px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"0px",borderRadius:(null==e?void 0:e.borderRadius)||"4px",border:(null==e?void 0:e.border)||"none",backgroundColor:(null==e?void 0:e.backgroundColor)||"#1890ff",color:(null==e?void 0:e.color)||"#ffffff",fontSize:(null==e?void 0:e.fontSize)||"14px"},disabled:d.disabled,onClick:C,children:d.text||"按钮"});case"image":return(0,a.jsx)(i.default,{style:{...n,display:"block",objectFit:"cover",width:(null==e?void 0:e.width)||"auto",height:(null==e?void 0:e.height)||"auto"},src:d.src||"https://via.placeholder.com/200x150?text=图片",alt:d.alt||"图片",width:200,height:150,onClick:C});case"input":return(0,a.jsx)("input",{style:{...n,paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"8px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"12px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"8px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"12px",border:(null==e?void 0:e.border)||"1px solid #d9d9d9",borderRadius:(null==e?void 0:e.borderRadius)||"4px",fontSize:(null==e?void 0:e.fontSize)||"14px",width:(null==e?void 0:e.width)||"100%"},type:d.type||"text",placeholder:d.placeholder||"请输入内容",onClick:C,onChange:()=>{}});case"container":return(0,a.jsx)("div",{ref:N,style:{...n,minHeight:"50px",paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"16px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"16px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"16px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"16px",backgroundColor:(null==e?void 0:e.backgroundColor)||"#f5f5f5",borderRadius:(null==e?void 0:e.borderRadius)||"4px",display:(null==e?void 0:e.display)||"flex",flexDirection:(null==e?void 0:e.flexDirection)||"column",gap:null==e?void 0:e.gap,...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3"}},onClick:C,children:m&&m.length>0?m.map(e=>(0,a.jsx)(g,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,a.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"list":return(0,a.jsx)("div",{ref:N,style:{...n,display:(null==e?void 0:e.display)||"flex",flexDirection:(null==e?void 0:e.flexDirection)||"column",gap:null==e?void 0:e.gap,...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3",borderRadius:"4px",padding:"8px"}},onClick:C,children:m&&m.length>0?m.map(e=>(0,a.jsx)(g,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,a.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"card":return(0,a.jsx)("div",{ref:N,style:{...n,backgroundColor:(null==e?void 0:e.backgroundColor)||"#ffffff",border:(null==e?void 0:e.border)||"1px solid #e8e8e8",borderRadius:(null==e?void 0:e.borderRadius)||"8px",paddingTop:(null==e?void 0:e.paddingTop)||(null==e?void 0:e.padding)||"16px",paddingRight:(null==e?void 0:e.paddingRight)||(null==e?void 0:e.padding)||"16px",paddingBottom:(null==e?void 0:e.paddingBottom)||(null==e?void 0:e.padding)||"16px",paddingLeft:(null==e?void 0:e.paddingLeft)||(null==e?void 0:e.padding)||"16px",boxShadow:(null==e?void 0:e.boxShadow)||"0 2px 8px rgba(0,0,0,0.1)",...j&&{backgroundColor:"#e3f2fd",border:"2px dashed #2196f3"}},onClick:C,children:m&&m.length>0?m.map(e=>(0,a.jsx)(g,{component:e,isSelected:f===e.id,onSelect:()=>y(e.id),mode:r},e.id)):(0,a.jsx)("div",{style:{color:j?"#2196f3":"#9ca3af",fontSize:"14px",padding:"16px",textAlign:"center",border:j?"2px dashed #2196f3":"2px dashed #d1d5db",borderRadius:"4px",backgroundColor:j?"#e3f2fd":"transparent"},children:j?"松开鼠标放置组件":"拖拽组件到这里"})});case"divider":return(0,a.jsx)("div",{style:{...n,width:(null==e?void 0:e.width)||"100%",height:(null==e?void 0:e.height)||"1px",backgroundColor:(null==e?void 0:e.backgroundColor)||"#e8e8e8",margin:(null==e?void 0:e.margin)||"16px 0"},onClick:C});case"space":return(0,a.jsx)("div",{style:{...n,width:(null==e?void 0:e.width)||"100%",height:(null==e?void 0:e.height)||"16px"},onClick:C});default:return(0,a.jsxs)("div",{style:n,onClick:C,children:["未知组件类型: ",o]})}}return(0,a.jsx)("div",{children:"预览模式待实现"})};return"editor"===r?(0,a.jsx)(c,{componentId:t.id,isSelected:l,componentName:t.name,children:w()}):w()}function h(){var e,t,l,r;let{getRootComponents:i,selectedComponentId:o,selectComponent:d,currentPage:c}=(0,s.U)(),u=i(),{isOver:x,setNodeRef:h}=(0,p.zM)({id:"canvas-drop-zone",data:{type:"canvas"}});return(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&o&&d(null)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[o,d]),(0,n.useEffect)(()=>{console.log("Canvas 组件数据:",{totalComponents:u.length,pageConfig:null==c?void 0:c.config,components:u.map(e=>{var t,l,a;return{id:e.id,type:e.type,name:e.name,hasChildren:!!(null==(t=e.children)?void 0:t.length),childrenCount:(null==(l=e.children)?void 0:l.length)||0,children:(null==(a=e.children)?void 0:a.map(e=>({id:e.id,type:e.type,name:e.name})))||[]}})})},[u,null==c?void 0:c.config]),(0,a.jsx)("div",{ref:h,onClick:e=>{e.target===e.currentTarget&&d(null)},onMouseDown:e=>{let t=e.clientX,l=e.clientY,a=e=>{let n=Math.abs(e.clientX-t),r=Math.abs(e.clientY-l);if(n<5&&r<5){let t=e.target;(t.classList.contains("min-h-full")||t.closest(".space-y-2"))&&d(null)}document.removeEventListener("mouseup",a)};document.addEventListener("mouseup",a)},style:(()=>{let e=null==c?void 0:c.config;if(!e)return{};let t={};return e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.backgroundImage&&(t.backgroundImage="url(".concat(e.backgroundImage,")"),t.backgroundSize="cover",t.backgroundPosition="center",t.backgroundRepeat="no-repeat"),e.minHeight&&(t.minHeight=e.minHeight),e.padding?t.padding=e.padding:(e.paddingTop&&(t.paddingTop=e.paddingTop),e.paddingRight&&(t.paddingRight=e.paddingRight),e.paddingBottom&&(t.paddingBottom=e.paddingBottom),e.paddingLeft&&(t.paddingLeft=e.paddingLeft)),e.maxWidth&&(t.maxWidth=e.maxWidth,t.marginLeft="auto",t.marginRight="auto"),e.fontFamily&&(t.fontFamily=e.fontFamily),e.fontSize&&(t.fontSize=e.fontSize),e.lineHeight&&(t.lineHeight=e.lineHeight),e.color&&(t.color=e.color),t})(),className:"min-h-full w-full transition-colors ".concat(x?"bg-blue-50 border-2 border-dashed border-blue-300":""," ").concat((null==c||null==(e=c.config)?void 0:e.padding)?"":"p-4"),children:0===u.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-400 text-center",children:(0,a.jsxs)("div",{style:{fontFamily:(null==c||null==(t=c.config)?void 0:t.fontFamily)||"system-ui, -apple-system, sans-serif",fontSize:(null==c||null==(l=c.config)?void 0:l.fontSize)||"14px",lineHeight:(null==c||null==(r=c.config)?void 0:r.lineHeight)||"1.6"},children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCF1"}),(0,a.jsx)("p",{className:"text-sm",children:"从左侧拖拽或点击组件来添加到页面"}),(0,a.jsx)("p",{className:"text-xs mt-2 opacity-75",children:"选中组件后按 ESC 键可取消选中"}),x&&(0,a.jsx)("p",{className:"text-xs mt-2 text-blue-600 font-medium",children:"松开鼠标放置组件"})]})}):(0,a.jsxs)("div",{children:[u.map(e=>(0,a.jsx)(g,{component:e,isSelected:o===e.id,onSelect:()=>d(e.id)},e.id)),o&&(0,a.jsx)("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-3 py-1 rounded-full text-xs opacity-75 pointer-events-none z-50",children:"按 ESC 键取消选中"}),x&&(0,a.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-3 py-1 rounded-full text-xs pointer-events-none z-50",children:"松开鼠标添加组件到页面"})]})})}l(99220);var m=l(40968),f=l(14582),y=l(4884),b=l(66474),v=l(5196);function j(e){let{control:t,value:l,onChange:n}=e,{type:r,label:s,placeholder:i,options:o,min:d,max:c,step:p,unit:u}=t,g=e=>{"string"==typeof e&&"number"===r?n((0,x.iE)(t.key,e)):n(e)};return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(m.b,{className:"block text-xs font-medium text-gray-700",children:s}),(()=>{switch(r){case"text":return(0,a.jsx)("input",{type:"text",value:l||"",onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:i});case"number":return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("input",{type:"number",value:"string"==typeof l?l.replace(/[^\d.-]/g,""):"",onChange:e=>g(e.target.value),className:"flex-1 px-2 py-1 border border-gray-300 rounded-l-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:i,min:d,max:c,step:p}),u&&(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 border border-l-0 border-gray-300 rounded-r-md text-xs text-gray-600 flex items-center",children:u})]});case"color":return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("input",{type:"color",value:l||"#ffffff",onChange:e=>g(e.target.value),className:"w-12 h-8 border border-gray-300 rounded-l-md cursor-pointer","aria-label":s}),(0,a.jsx)("input",{type:"text",value:l||"",onChange:e=>g(e.target.value),className:"flex-1 px-2 py-1 border border-l-0 border-gray-300 rounded-r-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"#ffffff"})]});case"select":var e;return(0,a.jsxs)(f.Root,{value:l||(null==o||null==(e=o[0])?void 0:e.value)||"",onValueChange:e=>g(e),children:[(0,a.jsxs)(f.Trigger,{className:"w-full inline-flex items-center justify-between px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)(f.Value,{}),(0,a.jsx)(f.Icon,{children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(f.Portal,{children:(0,a.jsx)(f.Content,{className:"bg-white rounded-md shadow-lg border border-gray-200 z-50",children:(0,a.jsx)(f.Viewport,{className:"p-1",children:null==o?void 0:o.map(e=>(0,a.jsxs)(f.Item,{value:e.value,className:"relative flex items-center px-3 py-2 text-sm rounded-sm cursor-pointer select-none hover:bg-gray-100 focus:bg-gray-100 focus:outline-none data-[highlighted]:bg-gray-100",children:[(0,a.jsx)(f.ItemText,{children:e.label}),(0,a.jsx)(f.ItemIndicator,{className:"absolute right-2",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]},e.value))})})})]});case"switch":return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.bL,{checked:l||!1,onCheckedChange:e=>g(e),className:"w-11 h-6 bg-gray-200 rounded-full relative data-[state=checked]:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,a.jsx)(y.zi,{className:"block w-5 h-5 bg-white rounded-full transition-transform duration-100 translate-x-0.5 will-change-transform data-[state=checked]:translate-x-5"})}),(0,a.jsx)(m.b,{className:"text-sm text-gray-700",children:l?"开启":"关闭"})]});case"textarea":return(0,a.jsx)("textarea",{value:l||"",onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:i,rows:3});case"url":return(0,a.jsx)("input",{type:"url",value:l||"",onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:i||"https://"});default:return null}})()]})}function N(e){let{group:t,values:l,onChange:n}=e,{title:r,controls:s}=t;return(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:r}),(0,a.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,a.jsx)(j,{control:e,value:l[e.key],onChange:t=>n(e.key,t)},e.key))})]})}var C=l(30064);function w(){let{selectedComponentId:e,getComponentById:t,updateComponent:l,currentPage:r,updatePageConfig:i,updatePageSEO:o,updatePageInfo:d}=(0,s.U)(),[c,p]=(0,n.useState)("props"),g=e?t(e):null;if(!g)return(0,a.jsx)("div",{className:"h-full flex flex-col",children:(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"页面配置"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:null==r?void 0:r.id})]})]}),(0,a.jsxs)(C.bL,{value:c,onValueChange:e=>p(e),children:[(0,a.jsxs)(C.B8,{className:"flex border-b border-gray-200",children:[(0,a.jsx)(C.l9,{value:"props",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"基本信息"}),(0,a.jsx)(C.l9,{value:"style",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"页面设置"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,a.jsxs)(C.UC,{value:"props",children:[(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"页面信息"}),(0,a.jsx)("div",{className:"space-y-3",children:[{type:"text",label:"页面名称",key:"name",placeholder:"请输入页面名称"},{type:"text",label:"页面标题",key:"title",placeholder:"请输入页面标题"},{type:"textarea",label:"页面描述",key:"description",placeholder:"请输入页面描述"}].map(e=>(0,a.jsx)(j,{control:e,value:null==r?void 0:r[e.key],onChange:t=>d({[e.key]:t})},e.key))})]}),(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"SEO 设置"}),(0,a.jsx)("div",{className:"space-y-3",children:[{type:"text",label:"关键词",key:"keywords",placeholder:"请输入关键词，用逗号分隔"},{type:"text",label:"作者",key:"author",placeholder:"请输入作者信息"},{type:"text",label:"Open Graph 标题",key:"ogTitle",placeholder:"社交媒体分享标题"},{type:"textarea",label:"Open Graph 描述",key:"ogDescription",placeholder:"社交媒体分享描述"}].map(e=>{var t;return(0,a.jsx)(j,{control:e,value:null==r||null==(t=r.seo)?void 0:t[e.key],onChange:t=>o({[e.key]:t})},e.key)})})]})]}),(0,a.jsx)(C.UC,{value:"style",children:(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"页面样式"}),(0,a.jsx)("div",{className:"space-y-3",children:[{type:"color",label:"背景颜色",key:"backgroundColor"},{type:"text",label:"最小高度",key:"minHeight",placeholder:"如：100vh, 600px"},{type:"number",label:"页面内边距",key:"padding",placeholder:"20",min:0,unit:"px"},{type:"select",label:"字体家族",key:"fontFamily",options:[{label:"系统字体",value:"system-ui"},{label:"Arial",value:"Arial"},{label:"Helvetica",value:"Helvetica"}]},{type:"number",label:"默认字体大小",key:"fontSize",placeholder:"14",min:8,max:72,unit:"px"},{type:"text",label:"行高",key:"lineHeight",placeholder:"如：1.6, 24px"},{type:"color",label:"默认文字颜色",key:"color"}].map(e=>{var t;return(0,a.jsx)(j,{control:e,value:null==r||null==(t=r.config)?void 0:t[e.key],onChange:t=>{let l="string"==typeof t?(0,x.iE)(e.key,t):t;i({[e.key]:l})}},e.key)})})]})})]})]})]})});let h=(0,u.VH)(g.type),{propertyConfig:m}=h,f=(t,a)=>{l(e,{props:{...g.props,[t]:a}})},y=(t,a)=>{let n="string"==typeof a?(0,x.iE)(t,a):a;l(e,{style:{...g.style,[t]:n}})};return(0,a.jsx)("div",{className:"h-full flex flex-col",children:(0,a.jsxs)("div",{className:"property-section",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)("span",{className:"text-2xl",children:h.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:h.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:g.id})]})]}),(0,a.jsxs)(C.bL,{value:c,onValueChange:e=>p(e),children:[(0,a.jsxs)(C.B8,{className:"flex border-b border-gray-200",children:[(0,a.jsx)(C.l9,{value:"props",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"属性"}),(0,a.jsx)(C.l9,{value:"style",className:"px-3 py-2 text-sm font-medium border-b-2 transition-colors data-[state=active]:border-blue-500 data-[state=active]:text-blue-600 data-[state=inactive]:border-transparent data-[state=inactive]:text-gray-500 hover:text-gray-700",children:"样式"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,a.jsx)(C.UC,{value:"props",children:m.props&&m.props.length>0?m.props.map(e=>(0,a.jsx)(N,{group:e,values:g.props,onChange:f},e.key)):(0,a.jsx)("div",{className:"property-section",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"此组件没有可配置的属性"})})}),(0,a.jsx)(C.UC,{value:"style",children:m.styles&&m.styles.length>0?m.styles.map(e=>(0,a.jsx)(N,{group:e,values:g.style||{},onChange:y},e.key)):(0,a.jsx)("div",{className:"property-section",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"此组件没有可配置的样式"})})})]})]})]})},e)}l(15495);var k=l(57434),S=l(62158),A=l(27213),L=l(89917),D=l(48293),E=l(15968),z=l(81586),H=l(87712),R=l(96042);k.A,S.A,A.A,L.A,D.A,E.A,z.A,H.A,R.A;var T=l(55028),O=l(48021),M=l(13052),P=l(54416),B=l(47924);let V={text:k.A,button:S.A,image:A.A,input:L.A,container:D.A,list:E.A,card:z.A,divider:H.A,space:R.A};function U(e){let{node:t,onSelect:l,onDelete:n,onToggleExpanded:r,onMove:s,isSelected:i}=e,o=(0,u.AV)(t.type),d=V[t.type]||k.A,c=t.children.length>0,{attributes:x,listeners:g,setNodeRef:h,isDragging:m}=(0,p.PM)({id:"tree-node-".concat(t.id),data:{type:"tree-node",nodeId:t.id,node:t}}),{isOver:f,setNodeRef:y}=(0,p.zM)({id:"tree-drop-before-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"before",canHaveChildren:o.canHaveChildren}}),{isOver:v,setNodeRef:j}=(0,p.zM)({id:"tree-drop-inside-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"inside",canHaveChildren:o.canHaveChildren},disabled:!o.canHaveChildren}),{isOver:N,setNodeRef:C}=(0,p.zM)({id:"tree-drop-after-".concat(t.id),data:{type:"tree-drop",nodeId:t.id,position:"after",canHaveChildren:o.canHaveChildren}});return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{ref:y,className:"h-1 ".concat(f?"bg-blue-400":"")}),(0,a.jsxs)("div",{ref:h,className:"group flex items-center py-1 px-2 cursor-pointer hover:bg-gray-50 ".concat(i?"bg-blue-100 text-blue-800":""," ").concat(m?"opacity-50":""," ").concat(v&&o.canHaveChildren?"bg-green-50 border-l-2 border-green-400":""),style:{paddingLeft:"".concat(16*t.depth+8,"px")},onClick:()=>{l(t.id)},children:[(0,a.jsx)("div",{...x,...g,className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 rounded mr-1 cursor-grab active:cursor-grabbing",children:(0,a.jsx)(O.A,{className:"h-3 w-3 text-gray-400"})}),c?(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),r(t.id)},className:"p-0.5 hover:bg-gray-200 rounded mr-1",children:t.isExpanded?(0,a.jsx)(b.A,{className:"h-3 w-3"}):(0,a.jsx)(M.A,{className:"h-3 w-3"})}):(0,a.jsx)("div",{className:"w-4 mr-1"}),(0,a.jsx)(d,{className:"h-4 w-4 mr-2 text-gray-500"}),(0,a.jsx)("span",{ref:o.canHaveChildren?j:void 0,className:"text-sm flex-1 truncate",children:t.name||o.name}),o.canHaveChildren&&(0,a.jsx)("span",{className:"text-xs px-1 py-0.5 bg-green-100 text-green-700 rounded text-[10px] mr-1",children:"容器"}),!t.isVisible&&(0,a.jsx)("span",{className:"text-xs px-1 py-0.5 bg-gray-100 text-gray-600 rounded text-[10px] mr-1",children:"隐藏"}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),n(t.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-100 hover:text-red-600 rounded","aria-label":"删除组件",children:(0,a.jsx)(P.A,{className:"h-3 w-3"})})]}),c&&t.isExpanded&&(0,a.jsx)("div",{children:t.children.map(e=>(0,a.jsx)(U,{node:e,onSelect:l,onDelete:n,onToggleExpanded:r,onMove:s,isSelected:i},e.id))}),(0,a.jsx)("div",{ref:C,className:"h-1 ".concat(N?"bg-blue-400":"")})]})}function I(){let{getTreeNodes:e,selectedComponentId:t,selectComponent:l,deleteComponent:r,toggleNodeExpanded:i,moveComponent:o,treeManager:d}=(0,s.U)(),[c,p]=(0,n.useState)(""),u=e();(0,n.useEffect)(()=>{console.log("TreeViewV2: 树节点更新",{nodeCount:u.length,nodes:u.map(e=>({id:e.id,name:e.name,type:e.type})),treeManagerExists:!!d})},[u,d]);let x=(0,n.useMemo)(()=>{if(!c)return u;let e=t=>t.reduce((t,l)=>{if(l.name.toLowerCase().includes(c.toLowerCase())||l.type.toLowerCase().includes(c.toLowerCase()))t.push(l);else if(l.children.length>0){let a=e(l.children);a.length>0&&t.push({...l,children:a,isExpanded:!0})}return t},[]);return e(u)},[u,c]),g=e=>{l(e)},h=t=>{console.log("TreeViewV2: 删除组件",t),console.log("TreeViewV2: 删除前节点数量",u.length),r(t),setTimeout(()=>{console.log("TreeViewV2: 删除后节点数量",e().length)},100)},m=e=>{i(e)},f=(e,t,l)=>{console.log("TreeViewV2: 移动组件",{dragId:e,hoverId:t,position:l}),o(e,t,l)};return 0===u.length?(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"p-3 border-b",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"搜索组件...",value:c,onChange:e=>p(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500 py-8",children:[(0,a.jsx)("div",{className:"text-4xl mb-3",children:"\uD83C\uDF33"}),(0,a.jsx)("p",{className:"text-sm",children:"暂无组件"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"拖拽组件到画布开始编辑"})]})]}):(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"p-3 border-b",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(B.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"搜索组件...",value:c,onChange:e=>p(e.target.value),className:"w-full pl-9 pr-3 py-2 text-sm border rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),(0,a.jsx)("div",{className:"px-3 py-2 bg-blue-50 border-b text-xs text-blue-700",children:"\uD83D\uDCA1 单击选中，箭头展开/收起，拖拽手柄重新排序，支持搜索过滤"}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:x.map(e=>(0,a.jsx)(U,{node:e,onSelect:g,onDelete:h,onToggleExpanded:m,onMove:f,isSelected:t===e.id},e.id))})]})}let F=(0,T.default)(()=>Promise.resolve().then(l.bind(l,99220)).then(e=>e.MaterialPanel),{loadableGenerated:{webpack:()=>[99220]},ssr:!1,loading:()=>(0,a.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,a.jsx)("div",{className:"text-xs text-gray-400 px-2 py-1 bg-gray-100 rounded",children:"\uD83D\uDD04 正在加載組件庫..."}),Array.from({length:10},(e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))]})});function _(){return(0,a.jsx)("div",{className:"w-80 border-r border-gray-200 bg-white flex flex-col",children:(0,a.jsxs)(C.bL,{defaultValue:"materials",className:"flex flex-col h-full",children:[(0,a.jsxs)(C.B8,{className:"flex border-b border-gray-200","aria-label":"左侧面板选项",children:[(0,a.jsxs)(C.l9,{value:"materials",className:" flex-1 px-4 py-3 text-sm font-medium text-center transition-colors text-gray-500 hover:text-gray-700 hover:bg-gray-50 data-[state=active]:text-blue-600 data-[state=active]:border-b-2  data-[state=active]:border-blue-600 data-[state=active]:bg-blue-50 ",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83E\uDDE9"}),"组件库"]}),(0,a.jsxs)(C.l9,{value:"tree",className:" flex-1 px-4 py-3 text-sm font-medium text-center transition-colors text-gray-500 hover:text-gray-700 hover:bg-gray-50 data-[state=active]:text-blue-600 data-[state=active]:border-b-2  data-[state=active]:border-blue-600 data-[state=active]:bg-blue-50 ",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83C\uDF33"}),"组件树"]})]}),(0,a.jsx)(C.UC,{value:"materials",className:"flex-1 overflow-hidden focus:outline-none",children:(0,a.jsx)("div",{className:"h-full p-4 overflow-y-auto",children:(0,a.jsx)(F,{})})}),(0,a.jsx)(C.UC,{value:"tree",className:"flex-1 overflow-hidden focus:outline-none",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto",children:(0,a.jsx)(I,{})})})]})})}var Z=l(85996),W=l(82502),q=l(26575);let J=[{id:"comp_1",type:"text",name:"标题文本",props:{text:"欢迎使用H5低代码编辑器"},style:{fontSize:"24px",fontWeight:"bold",color:"#333333",textAlign:"center",paddingTop:"20px",paddingBottom:"20px",paddingLeft:"20px",paddingRight:"20px",marginTop:"10px",marginBottom:"10px",marginLeft:"0px",marginRight:"0px"}},{id:"comp_2",type:"button",name:"主要按钮",props:{text:"开始体验"},style:{backgroundColor:"#1890ff",color:"#ffffff",paddingTop:"12px",paddingBottom:"12px",paddingLeft:"24px",paddingRight:"24px",borderRadius:"6px",fontSize:"16px",marginTop:"20px",marginBottom:"20px",marginLeft:"auto",marginRight:"auto",display:"block",width:"200px"}}],G={id:"page_1",name:"首页",title:"示例页面",description:"这是一个示例页面",config:{backgroundColor:"#ffffff",minHeight:"100vh",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif",fontSize:"14px",lineHeight:"1.6",color:"#333333"},seo:{keywords:"H5, 低代码, 编辑器",author:"H5 Editor",ogTitle:"示例页面",ogDescription:"这是一个H5低代码编辑器生成的示例页面"},components:J,createdAt:new Date("2024-01-01T00:00:00Z"),updatedAt:new Date("2024-01-01T00:00:00Z")},K={id:"project_1",name:"示例项目",description:"H5低代码编辑器示例项目",pages:[G],createdAt:new Date("2024-01-01T00:00:00Z"),updatedAt:new Date("2024-01-01T00:00:00Z")};function Y(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)().get("pageId"),{setCurrentPage:l,addComponent:i,moveComponent:o}=(0,s.U)(),{getPageById:d}=(0,q.s)(),c=(0,p.FR)((0,p.MS)(p.AN,{activationConstraint:{distance:8}}));return(0,n.useEffect)(()=>{requestAnimationFrame(()=>{if(t){let a=d(t);a?l(a):e.push("/")}else{let{page:e}={project:K,page:G,components:J};l(e)}})},[t,l,d,e]),(0,a.jsx)(p.Mp,{sensors:c,collisionDetection:p.fp,onDragEnd:e=>{var t,l,a;let{active:n,over:r}=e;if(r){if((null==(t=n.data.current)?void 0:t.type)==="material"){let e=n.data.current.config,t={id:"comp_".concat(Date.now()),type:e.type,name:e.name,props:e.defaultProps,style:e.defaultStyle};"canvas-drop-zone"===r.id?i(t):"string"==typeof r.id&&r.id.startsWith("component-")&&i(t,r.id.replace("component-",""))}else if((null==(l=n.data.current)?void 0:l.type)==="tree-node"&&(null==(a=r.data.current)?void 0:a.type)==="tree-drop"){let e=n.data.current.nodeId,t=r.data.current.nodeId,l=r.data.current.position;e!==t&&o(e,t,l)}}},children:(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,a.jsx)(Z.M,{}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)(_,{}),(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-8 overflow-auto",children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(W.Mj,{title:"页面编辑",children:(0,a.jsx)(h,{})})})}),(0,a.jsx)("div",{className:"w-[420px] property-panel overflow-y-auto",children:(0,a.jsx)(w,{})})]})]})})}function X(){return(0,a.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"正在加载编辑器..."})]})})}function Q(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)(X,{}),children:(0,a.jsx)(Y,{})})}},65420:(e,t,l)=>{Promise.resolve().then(l.bind(l,44311))},85996:(e,t,l)=>{"use strict";l.d(t,{o:()=>f,M:()=>h});var a=l(95155),n=l(10068),r=l(82502),s=l(61827),i=l(82727),o=l(89613),d=l(93654),c=l(48932),p=l(92657),u=l(4229),x=l(48587),g=l(12115);function h(){let[e,t]=(0,g.useState)(!1),l=(0,s.dj)(),{canUndo:h,canRedo:m,undo:f,redo:y,precompileStyles:b}=(0,n.U)(),v=(0,i.g0)(),j=async()=>{try{l.loading("正在准备预览..."),b(),await new Promise(e=>setTimeout(e,800)),window.location.href="/preview"}catch(e){l.error("预览失败"),console.error("预览失败:",e)}};return(0,a.jsxs)(o.Kq,{children:[(0,a.jsxs)("div",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"H5 Low Code Editor"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"未命名项目"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(r.sM,{showTooltip:!0}),(0,a.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:(0,a.jsxs)("button",{onClick:f,disabled:!h(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"撤销"]})}),(0,a.jsx)(o.ZL,{children:(0,a.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["撤销 (Ctrl+Z)",(0,a.jsx)(o.i3,{className:"fill-gray-900"})]})})]}),(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:(0,a.jsxs)("button",{onClick:y,disabled:!m(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"重做"]})}),(0,a.jsx)(o.ZL,{children:(0,a.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["重做 (Ctrl+Y)",(0,a.jsx)(o.i3,{className:"fill-gray-900"})]})})]}),(0,a.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:(0,a.jsxs)("button",{onClick:j,className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"预览"]})}),(0,a.jsx)(o.ZL,{children:(0,a.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览页面",(0,a.jsx)(o.i3,{className:"fill-gray-900"})]})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:(0,a.jsxs)("button",{onClick:()=>{l.success("项目已保存")},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"保存"]})}),(0,a.jsx)(o.ZL,{children:(0,a.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["保存项目",(0,a.jsx)(o.i3,{className:"fill-gray-900"})]})})]}),(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:(0,a.jsxs)("button",{onClick:()=>{try{if(!v)return void l.error("没有可导出的页面");t(!0)}catch(e){l.error("JSON 预览失败"),console.error("JSON 预览失败:",e)}},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-green-500 hover:bg-green-600 text-white rounded-md transition-colors",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"导出"]})}),(0,a.jsx)(o.ZL,{children:(0,a.jsxs)(o.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览并导出 JSON Schema",(0,a.jsx)(o.i3,{className:"fill-gray-900"})]})})]})]})]}),(0,a.jsx)(s.zZ,{open:e,onOpenChange:t,page:v,title:"JSON Schema 预览"})]})}var m=l(66766);function f(e){let{component:t,pageConfig:l}=e,{className:n}=t,{type:r,style:s}=t,i={};s&&Object.entries(s).forEach(e=>{let[t,l]=e;l&&(i[t]=l)});let o={};l&&(!i.fontFamily&&l.fontFamily&&(o.fontFamily=l.fontFamily),!i.fontSize&&l.fontSize&&(o.fontSize=l.fontSize),!i.lineHeight&&l.lineHeight&&(o.lineHeight=l.lineHeight),!i.color&&l.color&&(o.color=l.color));let d={...o,...i,boxSizing:"border-box"};switch(r){case"text":return(0,a.jsx)("span",{className:n,style:d,children:t.props.text||"文本内容"});case"button":return(0,a.jsx)("button",{className:"".concat(n," ").concat(n?"":"px-4 py-2 rounded hover:opacity-80 disabled:opacity-50"),style:d,disabled:t.props.disabled,children:t.props.text||"按钮"});case"image":return(0,a.jsx)(m.default,{style:d,src:t.props.src||"https://via.placeholder.com/200x150?text=图片",alt:t.props.alt||"图片",width:200,height:150},t.id);case"input":return(0,a.jsx)("input",{className:"".concat(n," ").concat(n?"":"px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"),style:d,type:t.props.type||"text",placeholder:t.props.placeholder||"请输入内容",readOnly:!0});case"container":return(0,a.jsx)("div",{className:"".concat(n," ").concat(n?"":"min-h-[50px]"),style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,a.jsx)(f,{component:e,pageConfig:l},e.id)):(0,a.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空容器"})});case"list":return(0,a.jsx)("div",{className:n,style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,a.jsx)(f,{component:e,pageConfig:l},e.id)):(0,a.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空列表"})});case"card":return(0,a.jsx)("div",{className:"".concat(n," ").concat(n?"":"bg-white rounded-lg shadow border"),style:d,children:t.children&&t.children.length>0?t.children.map(e=>(0,a.jsx)(f,{component:e,pageConfig:l},e.id)):(0,a.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空卡片"})});case"divider":return(0,a.jsx)("div",{className:"".concat(n," ").concat(n?"":"border-t border-gray-300"),style:d});case"space":return(0,a.jsx)("div",{className:n,style:d});default:return(0,a.jsxs)("div",{className:n,style:d,children:["未知组件类型: ",r]})}}},99220:(e,t,l)=>{"use strict";l.r(t),l.d(t,{MaterialPanel:()=>c});var a=l(95155),n=l(12115),r=l(33934),s=l(10068),i=l(89613),o=l(25472);let d=(0,n.memo)(function(e){let{config:t,onAddComponent:l,index:r}=e,s="material-".concat(t.type,"-").concat(r),{attributes:d,listeners:c,setNodeRef:p,transform:u,isDragging:x}=(0,o.PM)({id:s,data:{type:"material",config:t}}),g=(0,n.useCallback)(()=>{l(t)},[t,l]),h={transform:u?"translate3d(".concat(u.x,"px, ").concat(u.y,"px, 0)"):void 0,opacity:x?.5:1};return(0,a.jsxs)(i.bL,{children:[(0,a.jsx)(i.l9,{asChild:!0,children:(0,a.jsx)("button",{ref:p,style:h,...d,...c,onClick:g,className:"material-item w-full text-left cursor-grab active:cursor-grabbing hover:bg-gray-50 transition-colors","aria-label":"添加".concat(t.name,"組件"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 rounded-lg",children:[(0,a.jsx)("span",{className:"text-2xl",children:t.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:t.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t.description})]}),t.canHaveChildren&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded",children:"容器"})]})})}),(0,a.jsx)(i.ZL,{children:(0,a.jsxs)(i.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:[t.canHaveChildren?"拖拽到畫布或點擊添加容器組件":"拖拽到畫布或點擊添加組件",(0,a.jsx)(i.i3,{className:"fill-gray-900"})]})})]})}),c=(0,n.memo)(function(){let[e,t]=(0,n.useState)([]),[l,o]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{if(console.log("\uD83D\uDD27 MaterialPanel: 開始初始化組件系統..."),await (0,r.tx)(),e){let e=(0,r.uk)();console.log("✅ MaterialPanel: 組件初始化完成，獲取到",e.length,"個組件"),t(e),o(!0)}}catch(t){console.error("❌ MaterialPanel: 組件初始化失敗:",t),e&&o(!0)}})(),()=>{e=!1}},[]);let c=(0,n.useCallback)(e=>{let t={id:"comp_".concat(Date.now()),type:e.type,name:e.name,props:e.defaultProps,style:e.defaultStyle};s.U.getState().addComponent(t)},[]);return l?0===e.length?(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)("div",{className:"text-xs text-red-500 px-2 py-1 bg-red-50 rounded",children:"⚠️ 組件庫加載失敗，請刷新頁面重試"})}):(0,a.jsx)(i.Kq,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 px-2 py-1 bg-blue-50 rounded",children:"\uD83D\uDCA1 點擊添加到頁面，或拖拽到容器中"}),e.map((e,t)=>(0,a.jsx)(d,{config:e,onAddComponent:c,index:t},e.id))]})}):(0,a.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,a.jsx)("div",{className:"text-xs text-gray-400 px-2 py-1 bg-gray-100 rounded",children:"\uD83D\uDD04 正在加載組件庫..."}),Array.from({length:10},(e,t)=>(0,a.jsx)("div",{className:"h-16 bg-gray-200 rounded"},t))]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[874,277,861,407,858,887,999,18,827,502,441,684,358],()=>t(65420)),_N_E=e.O()}]);