(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{3229:(e,t,s)=>{Promise.resolve().then(s.bind(s,9727))},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8956:(e,t,s)=>{"use strict";s.d(t,{s:()=>l});var a=s(8693),r=s(6786);let n=()=>"page_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),l=(0,a.vt)()((0,r.Zr)((e,t)=>({pages:[],createPage:(s,a,r)=>{let{pages:l}=t(),c={id:n(),name:s,title:a,description:r,components:[],createdAt:new Date,updatedAt:new Date};return e({pages:[...l,c]}),c},updatePage:(s,a)=>{let{pages:r}=t();e({pages:r.map(e=>e.id===s?{...e,...a,updatedAt:new Date}:e)})},deletePage:s=>{let{pages:a}=t();e({pages:a.filter(e=>e.id!==s)})},getPageById:e=>{let{pages:s}=t();return s.find(t=>t.id===e)||null},duplicatePage:s=>{let{pages:a}=t(),r=a.find(e=>e.id===s);if(!r)return null;let l={...r,id:n(),name:"".concat(r.name," 副本"),title:"".concat(r.title," 副本"),createdAt:new Date,updatedAt:new Date};return e({pages:[...a,l]}),l},generatePageId:n}),{name:"pages-storage",version:1}))},9727:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(5155),r=s(2115),n=s(5695),l=s(68),c=s(8956),i=s(1184),d=s(2502);let u=(0,s(9946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function o(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)().get("pageId"),[s,o]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null),{components:h,precompileStyles:f}=(0,l.U)(),{getPageById:p}=(0,c.s)();return((0,r.useEffect)(()=>{(async()=>{try{if(o(!0),t){let s=p(t);if(!s)return void e.push("/");x(s)}f(),await new Promise(e=>requestAnimationFrame(e))}catch(e){console.error("预览初始化失败:",e)}finally{o(!1)}})()},[t,f,p,e]),s)?(0,a.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-100",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"正在加载预览..."})]})}):(0,a.jsxs)("div",{className:"h-screen flex flex-col bg-gray-100",children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:()=>{t?e.push("/editor?pageId=".concat(t)):e.push("/editor")},className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"返回编辑器"]}),(0,a.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"预览模式"})]}),(0,a.jsx)(d.sM,{showIcon:!0})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-8",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(d.Mj,{title:(null==m?void 0:m.title)||"H5 页面预览",maxHeight:"calc(100vh - 200px)",children:0===((null==m?void 0:m.components)||h).length?(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-500",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCF1"}),(0,a.jsx)("p",{className:"text-lg",children:"暂无内容"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"请返回编辑器添加组件"})]}):(0,a.jsx)("div",{className:"p-4 space-y-2",children:((null==m?void 0:m.components)||h).map(e=>(0,a.jsx)(i.o,{component:e},e.id))})})})})]})}function m(){return(0,a.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-100",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"正在加载预览..."})]})})}function x(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(m,{}),children:(0,a.jsx)(o,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[277,679,898,714,502,184,441,684,358],()=>t(3229)),_N_E=e.O()}]);