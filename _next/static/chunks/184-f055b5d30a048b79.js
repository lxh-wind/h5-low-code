"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{1184:(e,t,n)=>{n.d(t,{o:()=>y,M:()=>b});var s=n(5155),a=n(68),c=n(2502),r=n(9613),o=n(6621),i=n(3654),l=n(8932),d=n(2657),h=n(4229),x=n(1788),p=n(646),m=n(4861),u=n(4631),g=n(2115);function b(){let[e,t]=(0,g.useState)([]),{canUndo:n,canRedo:b,undo:f,redo:y,currentPage:j,precompileStyles:w}=(0,a.U)(),N=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=Date.now().toString();return t(t=>[...t,{id:s,title:e,type:n}]),s},v=e=>{t(t=>t.filter(t=>t.id!==e))},k=async()=>{try{let e=N("正在准备预览...","loading");w(),await new Promise(e=>setTimeout(e,800)),v(e),window.location.href="/preview"}catch(e){N("预览失败","error"),console.error("预览失败:",e)}};return(0,s.jsxs)(o.Kq,{swipeDirection:"right",children:[(0,s.jsx)(r.Kq,{children:(0,s.jsxs)("div",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"H5 Low Code Editor"}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"未命名项目"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(c.sM,{showTooltip:!0}),(0,s.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,s.jsxs)(r.bL,{children:[(0,s.jsx)(r.l9,{asChild:!0,children:(0,s.jsxs)("button",{onClick:f,disabled:!n(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,s.jsx)(i.A,{className:"h-4 w-4 mr-1"}),"撤销"]})}),(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["撤销 (Ctrl+Z)",(0,s.jsx)(r.i3,{className:"fill-gray-900"})]})})]}),(0,s.jsxs)(r.bL,{children:[(0,s.jsx)(r.l9,{asChild:!0,children:(0,s.jsxs)("button",{onClick:y,disabled:!b(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,s.jsx)(l.A,{className:"h-4 w-4 mr-1"}),"重做"]})}),(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["重做 (Ctrl+Y)",(0,s.jsx)(r.i3,{className:"fill-gray-900"})]})})]}),(0,s.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,s.jsxs)(r.bL,{children:[(0,s.jsx)(r.l9,{asChild:!0,children:(0,s.jsxs)("button",{onClick:k,className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"预览"]})}),(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览页面",(0,s.jsx)(r.i3,{className:"fill-gray-900"})]})})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(r.bL,{children:[(0,s.jsx)(r.l9,{asChild:!0,children:(0,s.jsxs)("button",{onClick:()=>{N("项目已保存","success")},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"保存"]})}),(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["保存项目",(0,s.jsx)(r.i3,{className:"fill-gray-900"})]})})]}),(0,s.jsxs)(r.bL,{children:[(0,s.jsx)(r.l9,{asChild:!0,children:(0,s.jsxs)("button",{onClick:()=>{try{if(!j)return void N("没有可导出的页面","error");let e=function(e,t){let n=(t||e.name||"GeneratedPage").replace(/[^a-zA-Z0-9]/g,"").replace(/^\d/,"Page$&"),s=e.components.map(e=>(function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,{type:s,props:a,style:c,children:r}=t,o="  ".repeat(n),i=[{text:"transition-all duration-200",button:"px-4 py-2 rounded transition-all hover:opacity-80",image:"block object-cover",input:"px-3 py-2 border rounded focus:outline-none focus:ring-2",container:"min-h-[50px]",card:"bg-white rounded-lg shadow border"}[s]||"",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return Object.entries(e).forEach(e=>{let[n,s]=e;if(s&&"0"!==s)switch(n){case"marginTop":t.push((s.includes("px"),"mt-[".concat(s,"]")));break;case"marginRight":t.push((s.includes("px"),"mr-[".concat(s,"]")));break;case"marginBottom":t.push((s.includes("px"),"mb-[".concat(s,"]")));break;case"marginLeft":t.push((s.includes("px"),"ml-[".concat(s,"]")));break;case"paddingTop":t.push((s.includes("px"),"pt-[".concat(s,"]")));break;case"paddingRight":t.push((s.includes("px"),"pr-[".concat(s,"]")));break;case"paddingBottom":t.push((s.includes("px"),"pb-[".concat(s,"]")));break;case"paddingLeft":t.push((s.includes("px"),"pl-[".concat(s,"]")));break;case"width":"100%"===s?t.push("w-full"):t.push("w-[".concat(s,"]"));break;case"height":"100%"===s?t.push("h-full"):t.push("h-[".concat(s,"]"));break;case"color":case"fontSize":t.push("text-[".concat(s,"]"));break;case"backgroundColor":t.push("bg-[".concat(s,"]"));break;case"fontWeight":"bold"===s?t.push("font-bold"):"normal"===s?t.push("font-normal"):t.push("font-[".concat(s,"]"))}}),t.join(" ")}(c)].filter(Boolean).join(" "),l=i?' className="'.concat(i,'"'):"";switch(s){case"text":return"".concat(o,"<div").concat(l,">").concat(a.text||"文本内容","</div>");case"button":return"".concat(o,"<button").concat(l,">").concat(a.text||"按钮","</button>");case"image":return"".concat(o,"<img").concat(l,' src="').concat(a.src||"",'" alt="').concat(a.alt||"图片",'" />');case"input":return"".concat(o,"<input").concat(l,' type="').concat(a.type||"text",'" placeholder="').concat(a.placeholder||"",'" />');default:{let t="";return r&&r.length>0&&(t="\n"+r.map(t=>e(t,n+1)).join("\n")+"\n"+o),"".concat(o,"<div").concat(l,">").concat(t,"</div>")}}})(e,2)).join("\n"),a=[];if(e.config){let t=e.config;t.backgroundColor&&a.push("backgroundColor: '".concat(t.backgroundColor,"'")),t.color&&a.push("color: '".concat(t.color,"'")),t.fontFamily&&a.push("fontFamily: '".concat(t.fontFamily,"'")),t.fontSize&&a.push("fontSize: '".concat(t.fontSize,"'")),t.lineHeight&&a.push("lineHeight: '".concat(t.lineHeight,"'")),t.minHeight&&a.push("minHeight: '".concat(t.minHeight,"'")),t.padding&&a.push("padding: '".concat(t.padding,"'")),t.maxWidth&&a.push("maxWidth: '".concat(t.maxWidth,"'"))}let c=a.length>0?"{".concat(a.join(", "),"}"):"{}",r=[];if(e.seo){let t=e.seo;t.keywords&&r.push('        <meta name="keywords" content="'.concat(t.keywords,'" />')),t.author&&r.push('        <meta name="author" content="'.concat(t.author,'" />')),t.ogTitle&&r.push('        <meta property="og:title" content="'.concat(t.ogTitle,'" />')),t.ogDescription&&r.push('        <meta property="og:description" content="'.concat(t.ogDescription,'" />')),t.ogImage&&r.push('        <meta property="og:image" content="'.concat(t.ogImage,'" />'))}let o=r.length>0?"import Head from 'next/head'\n\n":"",i=r.length>0?"      <Head>\n        <title>".concat(e.title,'</title>\n        <meta name="description" content="').concat(e.description||"",'" />\n').concat(r.join("\n"),"\n      </Head>\n      "):"";return"".concat(o,"import React from 'react'\n\nexport default function ").concat(n,"() {\n  return (\n    <>\n      ").concat(i,"<div \n        style={").concat(c,'}\n        className="min-h-screen"\n      >\n        <div className="max-w-md mx-auto bg-white rounded-lg shadow-lg overflow-hidden">\n').concat(s,"\n        </div>\n      </div>\n    </>\n  )\n}")}(j),t="".concat(j.name.replace(/[^a-zA-Z0-9]/g,"")||"H5Page",".tsx"),n=new Blob([e],{type:"text/javascript"}),s=URL.createObjectURL(n),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),N("代码导出成功","success")}catch(e){N("代码导出失败","error"),console.error("导出代码失败:",e)}},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors",children:[(0,s.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"导出"]})}),(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["导出代码",(0,s.jsx)(r.i3,{className:"fill-gray-900"})]})})]})]})]})}),e.map(e=>(0,s.jsxs)(o.bL,{className:"bg-white rounded-md shadow-lg border p-4 grid grid-cols-[auto_max-content] gap-x-4 items-center data-[state=open]:animate-slideIn data-[state=closed]:animate-hide data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=cancel]:transition-[transform_200ms_ease-out] data-[swipe=end]:animate-swipeOut",onOpenChange:t=>{t||v(e.id)},children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["success"===e.type?(0,s.jsx)(p.A,{className:"h-5 w-5 text-green-500"}):"error"===e.type?(0,s.jsx)(m.A,{className:"h-5 w-5 text-red-500"}):(0,s.jsx)(u.A,{className:"h-5 w-5 text-blue-500 animate-spin"}),(0,s.jsx)(o.hE,{className:"text-sm font-medium text-gray-900",children:e.title})]}),(0,s.jsx)(o.bm,{className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})]},e.id)),(0,s.jsx)(o.LM,{className:"fixed top-20 left-1/2 transform -translate-x-1/2 flex flex-col p-6 gap-2 w-96 max-w-[100vw] m-0 list-none z-50 outline-none"})]})}var f=n(6766);function y(e){let{component:t,pageConfig:n}=e,{className:a}=t,{type:c,style:r}=t,o={};r&&Object.entries(r).forEach(e=>{let[t,n]=e;n&&(o[t]=n)});let i={};n&&(!o.fontFamily&&n.fontFamily&&(i.fontFamily=n.fontFamily),!o.fontSize&&n.fontSize&&(i.fontSize=n.fontSize),!o.lineHeight&&n.lineHeight&&(i.lineHeight=n.lineHeight),!o.color&&n.color&&(i.color=n.color));let l={...i,...o,boxSizing:"border-box"};switch(c){case"text":return(0,s.jsx)("span",{className:a,style:l,children:t.props.text||"文本内容"});case"button":return(0,s.jsx)("button",{className:"".concat(a," ").concat(a?"":"px-4 py-2 rounded hover:opacity-80 disabled:opacity-50"),style:l,disabled:t.props.disabled,children:t.props.text||"按钮"});case"image":return(0,s.jsx)(f.default,{style:l,src:t.props.src||"https://via.placeholder.com/200x150?text=图片",alt:t.props.alt||"图片",width:200,height:150},t.id);case"input":return(0,s.jsx)("input",{className:"".concat(a," ").concat(a?"":"px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"),style:l,type:t.props.type||"text",placeholder:t.props.placeholder||"请输入内容",readOnly:!0});case"container":return(0,s.jsx)("div",{className:"".concat(a," ").concat(a?"":"min-h-[50px]"),style:l,children:t.children&&t.children.length>0?t.children.map(e=>(0,s.jsx)(y,{component:e,pageConfig:n},e.id)):(0,s.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空容器"})});case"list":return(0,s.jsx)("div",{className:a,style:l,children:t.children&&t.children.length>0?t.children.map(e=>(0,s.jsx)(y,{component:e,pageConfig:n},e.id)):(0,s.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空列表"})});case"card":return(0,s.jsx)("div",{className:"".concat(a," ").concat(a?"":"bg-white rounded-lg shadow border"),style:l,children:t.children&&t.children.length>0?t.children.map(e=>(0,s.jsx)(y,{component:e,pageConfig:n},e.id)):(0,s.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空卡片"})});case"divider":return(0,s.jsx)("div",{className:"".concat(a," ").concat(a?"":"border-t border-gray-300"),style:l});case"space":return(0,s.jsx)("div",{className:a,style:l});default:return(0,s.jsxs)("div",{className:a,style:l,children:["未知组件类型: ",c]})}}}}]);