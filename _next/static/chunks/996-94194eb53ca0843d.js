"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{85996:(e,s,t)=>{t.d(s,{o:()=>y,M:()=>g});var r=t(95155),l=t(10068),i=t(82502),a=t(61827),n=t(62978),c=t(89613),d=t(93654),o=t(48932),x=t(92657),h=t(4229),m=t(48587),p=t(12115);function g(){let[e,s]=(0,p.useState)(!1),t=(0,a.dj)(),{openPreview:g}=(0,n.bR)(),j=(0,n.f3)(),{canUndo:y,canRedo:u,undo:b,redo:f,precompileStyles:N,currentPage:v}=(0,l.U)(),w=(0,n.g0)(),C=async()=>{try{if(t.loading("正在准备预览...",1e3),!j())return void t.error("保存失敗，無法預覽");N(),await new Promise(e=>setTimeout(e,800)),g(null==v?void 0:v.id)}catch(e){t.error("预览失败"),console.error("预览失败:",e)}};return(0,r.jsxs)(c.Kq,{children:[(0,r.jsxs)("div",{className:"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"H5 Low Code Editor"}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"未命名项目"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(i.sM,{showTooltip:!0}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)(c.bL,{children:[(0,r.jsx)(c.l9,{asChild:!0,children:(0,r.jsxs)("button",{onClick:b,disabled:!y(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"撤销"]})}),(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["撤销 (Ctrl+Z)",(0,r.jsx)(c.i3,{className:"fill-gray-900"})]})})]}),(0,r.jsxs)(c.bL,{children:[(0,r.jsx)(c.l9,{asChild:!0,children:(0,r.jsxs)("button",{onClick:f,disabled:!u(),className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed rounded-md transition-colors",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"重做"]})}),(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["重做 (Ctrl+Y)",(0,r.jsx)(c.i3,{className:"fill-gray-900"})]})})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-gray-300 mx-2"}),(0,r.jsxs)(c.bL,{children:[(0,r.jsx)(c.l9,{asChild:!0,children:(0,r.jsxs)("button",{onClick:C,className:"inline-flex items-center justify-center px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-1"}),"预览"]})}),(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览页面",(0,r.jsx)(c.i3,{className:"fill-gray-900"})]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(c.bL,{children:[(0,r.jsx)(c.l9,{asChild:!0,children:(0,r.jsxs)("button",{onClick:()=>{j()?t.success("頁面已保存"):t.error("保存失敗，請重試")},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[(0,r.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"保存"]})}),(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["保存项目",(0,r.jsx)(c.i3,{className:"fill-gray-900"})]})})]}),(0,r.jsxs)(c.bL,{children:[(0,r.jsx)(c.l9,{asChild:!0,children:(0,r.jsxs)("button",{onClick:()=>{try{if(!w)return void t.error("没有可导出的页面");s(!0)}catch(e){t.error("JSON 预览失败"),console.error("JSON 预览失败:",e)}},className:"inline-flex items-center justify-center px-4 py-2 text-sm bg-green-500 hover:bg-green-600 text-white rounded-md transition-colors",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-1"}),"导出"]})}),(0,r.jsx)(c.ZL,{children:(0,r.jsxs)(c.UC,{className:"bg-gray-900 text-white px-2 py-1 rounded text-xs",sideOffset:5,children:["预览并导出 JSON Schema",(0,r.jsx)(c.i3,{className:"fill-gray-900"})]})})]})]})]}),(0,r.jsx)(a.zZ,{open:e,onOpenChange:s,page:w,title:"JSON Schema 预览"})]})}var j=t(66766);function y(e){let{component:s,pageConfig:t}=e,{className:l}=s,{type:i,style:a}=s,n={};a&&Object.entries(a).forEach(e=>{let[s,t]=e;t&&(n[s]=t)});let c={};t&&(!n.fontFamily&&t.fontFamily&&(c.fontFamily=t.fontFamily),!n.fontSize&&t.fontSize&&(c.fontSize=t.fontSize),!n.lineHeight&&t.lineHeight&&(c.lineHeight=t.lineHeight),!n.color&&t.color&&(c.color=t.color));let d={...c,...n,boxSizing:"border-box"};switch(i){case"text":return(0,r.jsx)("span",{className:l,style:d,children:s.props.text||"文本内容"});case"button":return(0,r.jsx)("button",{className:"".concat(l," ").concat(l?"":"px-4 py-2 rounded hover:opacity-80 disabled:opacity-50"),style:d,disabled:s.props.disabled,children:s.props.text||"按钮"});case"image":return(0,r.jsx)(j.default,{style:d,src:s.props.src||"https://via.placeholder.com/200x150?text=图片",alt:s.props.alt||"图片",width:200,height:150},s.id);case"input":return(0,r.jsx)("input",{className:"".concat(l," ").concat(l?"":"px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"),style:d,type:s.props.type||"text",placeholder:s.props.placeholder||"请输入内容",readOnly:!0});case"container":return(0,r.jsx)("div",{className:"".concat(l," ").concat(l?"":"min-h-[50px]"),style:d,children:s.children&&s.children.length>0?s.children.map(e=>(0,r.jsx)(y,{component:e,pageConfig:t},e.id)):(0,r.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空容器"})});case"list":return(0,r.jsx)("div",{className:l,style:d,children:s.children&&s.children.length>0?s.children.map(e=>(0,r.jsx)(y,{component:e,pageConfig:t},e.id)):(0,r.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空列表"})});case"card":return(0,r.jsx)("div",{className:"".concat(l," ").concat(l?"":"bg-white rounded-lg shadow border"),style:d,children:s.children&&s.children.length>0?s.children.map(e=>(0,r.jsx)(y,{component:e,pageConfig:t},e.id)):(0,r.jsx)("div",{className:"text-gray-400 text-sm p-4 text-center",children:"空卡片"})});case"divider":return(0,r.jsx)("div",{className:"".concat(l," ").concat(l?"":"border-t border-gray-300"),style:d});case"space":return(0,r.jsx)("div",{className:l,style:d});default:return(0,r.jsxs)("div",{className:l,style:d,children:["未知组件类型: ",i]})}}}}]);